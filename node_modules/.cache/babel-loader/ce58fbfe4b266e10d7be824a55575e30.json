{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/components/orders/v2/ShippingGroup.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Item } from \"./Item\";\nimport cx from 'classnames';\nimport cmStyles from \"./Common.module.css\";\nimport { Button, Clickable } from 'phoenix-components';\nimport { useToggle } from \"../../../hooks/common\";\nimport chevUp from \"../../../assets/v2/orders/chevUpPrimary.svg\";\nimport chevDown from \"../../../assets/v2/orders/chevDownPrimary.svg\";\nimport { ShippingModal } from \"../ShippingModal\";\nimport { useOrder } from \"../../../contexts/orderContext\";\nimport { Drawer } from '@material-ui/core';\nimport locationIcon from \"../../../assets/images/orders/details/route.svg\";\nimport _, { get } from 'lodash';\nimport { TrackingPopOver } from \"../TrackingPopOver\";\nimport emailIcon from \"../../../assets/images/email.svg\";\nimport downloadIcon from \"../../../assets/images/orders/details/download.svg\";\nimport deliveryTag from \"../../../assets/images/orders/details/tag.svg\";\nimport Loader from \"../../../services/loader\";\nimport { Factory } from \"../../../api\";\nimport SnackBar from \"../../../services/snackbar\";\nimport CONFIG from \"../../../config\";\nimport Storage from \"../../../services/storage\";\nimport WebView from \"../../../services/webview\";\nimport fileDownload from 'js-file-download';\nimport { useIsWebView } from \"../../../hooks\";\nimport styles from \"./ShippingGroup.module.css\";\nexport function ShippingGroup({\n  group\n}) {\n  _s();\n\n  const [open, toggleOpen] = useToggle();\n  const [retryShipping, toggleRetryShipping] = useToggle();\n  const order = useOrder();\n\n  const enableTracking = _.get(group, 'buttons.enableTracking', false);\n\n  const enableDownloadLabel = get(group, 'buttons.enableDownloadLabel', false);\n  const [popOverEL, setPopOverEl] = useState(null);\n  const [downloadEl, setDownloadEl] = useState(null);\n  const webview = useIsWebView();\n\n  const openPopOver = e => {\n    setPopOverEl(e.currentTarget);\n  };\n\n  const closePopOver = () => {\n    setPopOverEl(null);\n  };\n\n  const openDownload = e => {\n    setDownloadEl(e.currentTarget);\n  };\n\n  const closeDownload = () => {\n    setDownloadEl(false);\n  };\n\n  const sendEmail = async () => {\n    try {\n      Loader.show();\n      await Factory.sendEmailLabel(order._id, group._id);\n      SnackBar.show('Sent to your email');\n    } catch (e) {\n      SnackBar.show('Something went wrong', 'error');\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const downloadLabel = async () => {\n    const path = `${order._id}/${group._id}`;\n\n    try {\n      Loader.show();\n\n      if (webview) {\n        const url = `${CONFIG.FACTORY.host}/seller/orders/${path}/label?authorization=${Storage.getItem('token')}`;\n        await WebView.download(url);\n        return;\n      }\n\n      const {\n        data,\n        headers\n      } = await Factory.getLabel(order._id, group._id);\n      fileDownload(data, headers['x-suggested-filename'], headers['content-type']);\n    } catch (e) {\n      SnackBar.show('Something went wrong', 'error');\n    } finally {\n      closeDownload();\n      Loader.hide();\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Drawer, {\n    anchor: \"bottom\",\n    open: !!popOverEL,\n    onClose: closePopOver,\n    PaperProps: {\n      classes: {\n        root: styles.paper\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }, !!popOverEL && /*#__PURE__*/React.createElement(TrackingPopOver, {\n    order: order,\n    groupId: group._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 26\n    }\n  })), /*#__PURE__*/React.createElement(Drawer, {\n    anchor: \"bottom\",\n    open: !!downloadEl,\n    onClose: closeDownload,\n    PaperProps: {\n      classes: {\n        root: styles.paper\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.downloadPopoverRoot,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    onClick: sendEmail,\n    className: cx(styles.downloadPopoverContainer, styles.border),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: emailIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.downloadPopoverLabel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  }, \"Send to email\")), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: downloadLabel,\n    className: styles.downloadPopoverContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: downloadIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.downloadPopoverLabel),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, \"Download\")))), retryShipping && /*#__PURE__*/React.createElement(ShippingModal, {\n    groupId: group._id,\n    order: order,\n    onClose: toggleRetryShipping,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }), group.items.map(item => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Item, {\n    item: item,\n    key: item._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(cmStyles.marginV20),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }))), (enableTracking || enableDownloadLabel || group.type === 'self' || group.type === 'windo') && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.accordion,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Clickable, {\n    onClick: toggleOpen,\n    className: styles.opener,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, \"Shipping Details\"), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"spacer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }), group.status === 'shipping pending' && /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.actionPending,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  }, \"Action Pending\"), /*#__PURE__*/React.createElement(\"img\", {\n    src: open ? chevUp : chevDown,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  })), open && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.accordionContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 13\n    }\n  }, group.status === 'shipping pending' && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.shippingFailedStatus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  }, \"Shipping Status\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, \":\"), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }, \"Failed\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flexCenter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    label: \"Retry\",\n    onClick: toggleRetryShipping,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 21\n    }\n  }))), group.status !== 'shipping pending' && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.flexContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 17\n    }\n  }, enableTracking && /*#__PURE__*/React.createElement(Clickable, {\n    onClick: openPopOver,\n    className: styles.iconContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: locationIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconLabel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 23\n    }\n  }, \"Track Order\")), enableDownloadLabel && /*#__PURE__*/React.createElement(Clickable, {\n    onClick: openDownload,\n    className: styles.iconContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: deliveryTag,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 23\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.iconLabel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 23\n    }\n  }, \"Shipping Label\"))))));\n}\n\n_s(ShippingGroup, \"vn2PrI6RlZoc/ZXGcHBvizC1bm0=\", false, function () {\n  return [useToggle, useToggle, useOrder, useIsWebView];\n});\n\n_c = ShippingGroup;\nShippingGroup.propTypes = {\n  group: PropTypes.object.isRequired\n};\nShippingGroup.defaultProps = {};\n\nvar _c;\n\n$RefreshReg$(_c, \"ShippingGroup\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/components/orders/v2/ShippingGroup.jsx"],"names":["React","useState","PropTypes","Item","cx","cmStyles","Button","Clickable","useToggle","ShippingModal","useOrder","Drawer","_","get","TrackingPopOver","Loader","Factory","SnackBar","CONFIG","Storage","WebView","fileDownload","useIsWebView","styles","ShippingGroup","group","open","toggleOpen","retryShipping","toggleRetryShipping","order","enableTracking","enableDownloadLabel","popOverEL","setPopOverEl","downloadEl","setDownloadEl","webview","openPopOver","e","currentTarget","closePopOver","openDownload","closeDownload","sendEmail","show","sendEmailLabel","_id","hide","downloadLabel","path","url","FACTORY","host","getItem","download","data","headers","getLabel","container","classes","root","paper","downloadPopoverRoot","downloadPopoverContainer","border","emailIcon","downloadPopoverLabel","downloadIcon","items","map","item","marginV20","type","accordion","opener","title","status","actionPending","chevUp","chevDown","accordionContainer","shippingFailedStatus","flexContainer","iconContainer","locationIcon","iconLabel","deliveryTag","propTypes","object","isRequired","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Item } from 'components/orders/v2/Item';\nimport cx from 'classnames';\nimport cmStyles from 'components/orders/v2/Common.module.css';\nimport { Button, Clickable } from 'phoenix-components';\nimport { useToggle } from 'hooks/common';\nimport chevUp from 'assets/v2/orders/chevUpPrimary.svg';\nimport chevDown from 'assets/v2/orders/chevDownPrimary.svg';\nimport { ShippingModal } from 'components/orders/ShippingModal';\nimport { useOrder } from 'contexts/orderContext';\nimport { Drawer } from '@material-ui/core';\nimport locationIcon from 'assets/images/orders/details/route.svg';\nimport _, { get } from 'lodash';\nimport { TrackingPopOver } from 'components/orders/TrackingPopOver';\nimport emailIcon from 'assets/images/email.svg';\nimport downloadIcon from 'assets/images/orders/details/download.svg';\nimport deliveryTag from 'assets/images/orders/details/tag.svg';\nimport Loader from 'services/loader';\nimport { Factory } from 'api';\nimport SnackBar from 'services/snackbar';\nimport CONFIG from 'config';\nimport Storage from 'services/storage';\nimport WebView from 'services/webview';\nimport fileDownload from 'js-file-download';\nimport { useIsWebView } from 'hooks';\nimport styles from './ShippingGroup.module.css';\n\nexport function ShippingGroup({ group }) {\n  const [open, toggleOpen] = useToggle();\n  const [retryShipping, toggleRetryShipping] = useToggle();\n  const order = useOrder();\n  const enableTracking = _.get(group, 'buttons.enableTracking', false);\n  const enableDownloadLabel = get(group, 'buttons.enableDownloadLabel', false);\n  const [popOverEL, setPopOverEl] = useState(null);\n  const [downloadEl, setDownloadEl] = useState(null);\n  const webview = useIsWebView();\n\n  const openPopOver = (e) => {\n    setPopOverEl(e.currentTarget);\n  };\n\n  const closePopOver = () => {\n    setPopOverEl(null);\n  };\n\n  const openDownload = (e) => {\n    setDownloadEl(e.currentTarget);\n  };\n\n  const closeDownload = () => {\n    setDownloadEl(false);\n  };\n\n  const sendEmail = async () => {\n    try {\n      Loader.show();\n      await Factory.sendEmailLabel(order._id, group._id);\n      SnackBar.show('Sent to your email');\n    } catch (e) {\n      SnackBar.show('Something went wrong', 'error');\n    } finally {\n      Loader.hide();\n    }\n  };\n  const downloadLabel = async () => {\n    const path = `${order._id}/${group._id}`;\n    try {\n      Loader.show();\n      if (webview) {\n        const url = `${CONFIG.FACTORY.host}/seller/orders/${path}/label?authorization=${Storage.getItem('token')}`;\n        await WebView.download(url);\n        return;\n      }\n      const {\n        data,\n        headers\n      } = await Factory.getLabel(order._id, group._id);\n      fileDownload(data, headers['x-suggested-filename'], headers['content-type']);\n    } catch (e) {\n      SnackBar.show('Something went wrong', 'error');\n    } finally {\n      closeDownload();\n      Loader.hide();\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <Drawer\n        anchor=\"bottom\"\n        open={!!popOverEL}\n        onClose={closePopOver}\n        PaperProps={{\n          classes: {\n            root: styles.paper,\n          }\n        }}\n      >\n        {!!popOverEL && (<TrackingPopOver order={order} groupId={group._id} />)}\n      </Drawer>\n      <Drawer\n        anchor=\"bottom\"\n        open={!!downloadEl}\n        onClose={closeDownload}\n        PaperProps={{\n          classes: {\n            root: styles.paper,\n          }\n        }}\n      >\n        <div className={styles.downloadPopoverRoot}>\n          <div onClick={sendEmail} className={cx(styles.downloadPopoverContainer, styles.border)}>\n            <img src={emailIcon} alt=\"\" />\n            <div className={styles.downloadPopoverLabel}>Send to email</div>\n          </div>\n          <div onClick={downloadLabel} className={styles.downloadPopoverContainer}>\n            <img src={downloadIcon} alt=\"\" />\n            <div className={cx(styles.downloadPopoverLabel)}>Download</div>\n          </div>\n        </div>\n      </Drawer>\n      {retryShipping && (\n        <ShippingModal groupId={group._id} order={order} onClose={toggleRetryShipping} />\n      )}\n      {group.items.map(item => (\n        <>\n          <Item item={item} key={item._id} />\n          <div className={cx(cmStyles.marginV20)} />\n        </>\n      ))}\n      {(enableTracking || enableDownloadLabel || group.type === 'self' || group.type === 'windo') && (\n        <div className={styles.accordion}>\n          <Clickable onClick={toggleOpen} className={styles.opener}>\n            <span className={styles.title}>Shipping Details</span>\n            <span className=\"spacer\" />\n            {group.status === 'shipping pending' && (\n              <span className={styles.actionPending}>\n                Action Pending\n              </span>\n            )}\n            <img src={open ? chevUp : chevDown} alt=\"\" />\n          </Clickable>\n          {open && (\n            <div className={styles.accordionContainer}>\n              {group.status === 'shipping pending' && (\n                <div>\n                  <div className={styles.shippingFailedStatus}>\n                    <span>Shipping Status</span>\n                    <span>:</span>\n                    <span>Failed</span>\n                  </div>\n                  <div className=\"flexCenter\">\n                    <Button\n                      label=\"Retry\"\n                      onClick={toggleRetryShipping}\n                    />\n                  </div>\n                </div>\n              )}\n              {group.status !== 'shipping pending' && (\n                <div className={styles.flexContainer}>\n                  {enableTracking && (\n                    <Clickable onClick={openPopOver} className={styles.iconContainer}>\n                      <img src={locationIcon} alt=\"\" />\n                      <div className={styles.iconLabel}>Track Order</div>\n                    </Clickable>\n                  )}\n\n                  {enableDownloadLabel && (\n                    <Clickable onClick={openDownload} className={styles.iconContainer}>\n                      <img src={deliveryTag} alt=\"\" />\n                      <div className={styles.iconLabel}>Shipping Label</div>\n                    </Clickable>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nShippingGroup.propTypes = {\n  group: PropTypes.object.isRequired,\n};\n\nShippingGroup.defaultProps = {};\n"]},"metadata":{},"sourceType":"module"}