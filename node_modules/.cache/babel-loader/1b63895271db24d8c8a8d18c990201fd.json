{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/containers/orders/ListDesktop.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { InfiniteLoader, Grid } from 'react-virtualized';\nimport { useInfiniteOrders, useQueryParams } from \"../../hooks\";\nimport { OrderCard } from \"../../components/orders\";\nimport { Loading } from \"../../components/shared/Loading\";\nimport { Picker } from \"../../components/shared/dateRangePicker/Picker\";\nimport emptyOrder from \"../../assets/overview/newOrder.svg\";\nimport _, { isEmpty } from 'lodash';\nimport { useIsCartAbandonmentEnabled } from \"../../contexts\";\nimport cx from 'classnames';\nimport { customDateFilters, getText } from \"../utils\";\nimport { Button, Search } from 'phoenix-components';\nimport { StatusSelectionBar } from \"../../components/shared/StatusSelectionBar\";\nimport { Header } from \"../../components/shared/Header\";\nimport Details from \"./Details\";\nimport Filters from \"./Filters\";\nimport { placedList, FilterMap, dateFilters } from \"./utils\";\nimport styles from \"./ListDesktop.module.css\";\n\nfunction OrderList() {\n  _s();\n\n  const params = useQueryParams();\n  const state = params.get('state') || 'all';\n  const place = params.get('placed') || 'week';\n  const custom = params.has('custom') ? params.get('custom') : '';\n  const [query, setQuery] = useState('');\n  const [dateRangeFilters, setDateRangeFilters] = useState({\n    from: null,\n    to: null\n  });\n  const isEmptyFrom = dateRangeFilters.from === null;\n  const isEmptyTo = dateRangeFilters.to === null;\n  const screenWidth = window.screen.width - 320 - 80 - 160;\n\n  const statusFilters = () => {\n    // if (isEmpty(custom)) {\n    //   return (FilterMap[state] || FilterMap.active);\n    // }\n    const selected = !isEmpty(custom) ? custom.split(',') : [state];\n    const items = selected.map(y => FilterMap[y]);\n\n    if (!isEmpty(items)) {\n      return {\n        $or: _.flatten(items)\n      };\n    }\n\n    return {};\n  };\n\n  const dateTimeFilters = () => {\n    if (place !== 'custom') {\n      return dateFilters[place];\n    }\n\n    if (isEmptyFrom || isEmptyTo) {\n      return {};\n    }\n\n    return customDateFilters(dateRangeFilters.from, dateRangeFilters.to);\n  };\n\n  const searchFilters = () => {\n    if (query.length > 0) {\n      return {\n        externalId: {\n          $regex: `${query === null || query === void 0 ? void 0 : query.replace('#', '')}`,\n          $options: 'i'\n        }\n      };\n    }\n\n    return {};\n  };\n\n  const [orders, loadMore, hasMore, loading, refresh] = useInfiniteOrders({ ...dateTimeFilters(),\n    ...statusFilters(),\n    ...searchFilters()\n  }, {\n    createdAt: -1\n  });\n  const history = useHistory();\n  const isCartAbandonmentEnabled = useIsCartAbandonmentEnabled();\n  const isLoading = orders.length === 0 && loading;\n  const id = params.get('id');\n\n  const onSectionRendered = onRowsRendered => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 2 + columnStartIndex;\n    const stopIndex = rowStopIndex * 2 + columnStopIndex;\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  const rowCount = hasMore ? 10000 : orders.length;\n\n  const isLoaded = i => !!orders[i];\n\n  const height = window.screen.height - 90 - 350;\n\n  if (isLoading && !params.has('placed')) {\n    return /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 7\n      }\n    });\n  }\n\n  const show = item => {\n    if ((item === null || item === void 0 ? void 0 : item.status) === 'cart cancelled' || (item === null || item === void 0 ? void 0 : item.orderStatus) === 'cart cancelled') {\n      return !isCartAbandonmentEnabled;\n    }\n\n    return false;\n  };\n\n  const renderCell = el => {\n    const idx = el.rowIndex * 2 + el.columnIndex;\n\n    if (idx >= orders.length) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: el.key,\n      style: el.style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(OrderCard, {\n      refresh: refresh,\n      showBorder: idx % 2 === 0,\n      order: orders[idx],\n      showAlert: show(orders[idx]),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  const onCreateChange = val => {\n    setDateRangeFilters({\n      from: null,\n      to: null\n    });\n    params.set('placed', val);\n    history.push({\n      search: params.toString()\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: cx('flexBetween', styles.section),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Picker, {\n    label: getText(dateRangeFilters),\n    onSelect: e => {\n      const isEmptyValue = Object.keys(e).length === 0;\n      setDateRangeFilters(e);\n      params.set('placed', !isEmptyValue ? 'custom' : 'all');\n      history.push({\n        search: params.toString()\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.searchDiv,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Search, {\n    value: query,\n    placeholder: \"Search by order ID\",\n    className: styles.searchBar,\n    onChange: e => setQuery(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    label: \"Search\",\n    size: \"small\",\n    primary: true,\n    className: styles.Searchbutton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(StatusSelectionBar, {\n    tabClassName: styles.tabClassName,\n    className: styles.tabClass,\n    activeClass: styles.tabActive,\n    items: placedList,\n    onChange: onCreateChange,\n    active: place,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.filters,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Filters, {\n    onSelect: e => {\n      params.delete('state');\n      params.set('custom', e.join(','));\n      history.push({\n        search: params.toString()\n      });\n    },\n    selected: custom.length > 0 ? custom.split(',') : [],\n    reset: custom.length === 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  }, \"Orders List\", ' ', /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.span,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 11\n    }\n  }, \"(\", ' ', orders.length, ' ', \"orders )\")), orders.length > 0 ? /*#__PURE__*/React.createElement(InfiniteLoader, {\n    loadMoreRows: loadMore,\n    isRowLoaded: isLoaded,\n    rowCount: rowCount,\n    minimumBatchSize: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 11\n    }\n  }, ({\n    onRowsRendered,\n    registerChild\n  }) => /*#__PURE__*/React.createElement(Grid, {\n    onSectionRendered: onSectionRendered(onRowsRendered),\n    ref: registerChild,\n    cellRenderer: renderCell,\n    columnCount: 2,\n    columnWidth: screenWidth / 2,\n    height: height,\n    rowCount: Math.ceil(rowCount / 2),\n    rowHeight: 134,\n    width: screenWidth,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 15\n    }\n  })) : /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.emptyOrders,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: emptyOrder,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.emptyProductText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  }, \"You haven't received any orders yet!\"))), /*#__PURE__*/React.createElement(Details, {\n    open: !!id,\n    id: id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }\n  }));\n}\n\n_s(OrderList, \"uR+p5EIEvytk0IaNcp4a56IAw1w=\", false, function () {\n  return [useQueryParams, useInfiniteOrders, useHistory, useIsCartAbandonmentEnabled];\n});\n\n_c = OrderList;\nexport default OrderList;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderList\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/containers/orders/ListDesktop.jsx"],"names":["React","useState","useHistory","InfiniteLoader","Grid","useInfiniteOrders","useQueryParams","OrderCard","Loading","Picker","_","isEmpty","useIsCartAbandonmentEnabled","cx","customDateFilters","getText","Button","Search","StatusSelectionBar","Header","Details","Filters","placedList","FilterMap","dateFilters","styles","OrderList","params","state","get","place","custom","has","query","setQuery","dateRangeFilters","setDateRangeFilters","from","to","isEmptyFrom","isEmptyTo","screenWidth","window","screen","width","statusFilters","selected","split","items","map","y","$or","flatten","dateTimeFilters","searchFilters","length","externalId","$regex","replace","$options","orders","loadMore","hasMore","loading","refresh","createdAt","history","isCartAbandonmentEnabled","isLoading","id","onSectionRendered","onRowsRendered","columnStartIndex","columnStopIndex","rowStartIndex","rowStopIndex","startIndex","stopIndex","rowCount","isLoaded","i","height","show","item","status","orderStatus","renderCell","el","idx","rowIndex","columnIndex","key","style","onCreateChange","val","set","push","search","toString","container","content","section","e","isEmptyValue","Object","keys","searchDiv","searchBar","target","value","Searchbutton","tabClassName","tabClass","tabActive","filters","delete","join","text","span","registerChild","Math","ceil","emptyOrders","emptyOrder","emptyProductText"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { InfiniteLoader, Grid } from 'react-virtualized';\nimport { useInfiniteOrders, useQueryParams } from 'hooks';\nimport { OrderCard } from 'components/orders';\nimport { Loading } from 'components/shared/Loading';\nimport { Picker } from 'components/shared/dateRangePicker/Picker';\nimport emptyOrder from 'assets/overview/newOrder.svg';\nimport _, { isEmpty } from 'lodash';\nimport { useIsCartAbandonmentEnabled } from 'contexts';\nimport cx from 'classnames';\nimport { customDateFilters, getText } from 'containers/utils';\nimport { Button, Search } from 'phoenix-components';\nimport { StatusSelectionBar } from 'components/shared/StatusSelectionBar';\nimport { Header } from 'components/shared/Header';\nimport Details from './Details';\nimport Filters from './Filters';\nimport { placedList, FilterMap, dateFilters } from './utils';\nimport styles from './ListDesktop.module.css';\n\nfunction OrderList() {\n  const params = useQueryParams();\n  const state = params.get('state') || 'all';\n  const place = params.get('placed') || 'week';\n  const custom = params.has('custom') ? params.get('custom') : '';\n  const [query, setQuery] = useState('');\n  const [dateRangeFilters, setDateRangeFilters] = useState({\n    from: null,\n    to: null\n  });\n  const isEmptyFrom = dateRangeFilters.from === null;\n  const isEmptyTo = dateRangeFilters.to === null;\n\n  const screenWidth = window.screen.width - 320 - 80 - 160;\n\n  const statusFilters = () => {\n    // if (isEmpty(custom)) {\n    //   return (FilterMap[state] || FilterMap.active);\n    // }\n    const selected = !isEmpty(custom) ? custom.split(',') : [state];\n    const items = selected.map(y => FilterMap[y]);\n    if (!isEmpty(items)) {\n      return ({ $or: _.flatten(items) });\n    }\n    return {};\n  };\n\n  const dateTimeFilters = () => {\n    if (place !== 'custom') {\n      return dateFilters[place];\n    }\n    if (isEmptyFrom || isEmptyTo) {\n      return {};\n    }\n    return customDateFilters(dateRangeFilters.from, dateRangeFilters.to);\n  };\n\n  const searchFilters = () => {\n    if (query.length > 0) {\n      return { externalId: { $regex: `${query?.replace('#', '')}`, $options: 'i' } };\n    }\n    return {};\n  };\n\n  const [orders, loadMore, hasMore, loading, refresh] = useInfiniteOrders({\n    ...dateTimeFilters(),\n    ...statusFilters(),\n    ...searchFilters(),\n  }, {\n    createdAt: -1,\n  });\n  const history = useHistory();\n  const isCartAbandonmentEnabled = useIsCartAbandonmentEnabled();\n  const isLoading = orders.length === 0 && loading;\n\n  const id = params.get('id');\n\n  const onSectionRendered = (onRowsRendered) => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 2 + columnStartIndex;\n    const stopIndex = rowStopIndex * 2 + columnStopIndex;\n\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  const rowCount = hasMore ? 10000 : orders.length;\n\n  const isLoaded = i => !!orders[i];\n\n  const height = window.screen.height - 90 - 350;\n\n  if (isLoading && !params.has('placed')) {\n    return (\n      <Loading />\n    );\n  }\n\n  const show = (item) => {\n    if (item?.status === 'cart cancelled' || item?.orderStatus === 'cart cancelled') {\n      return !isCartAbandonmentEnabled;\n    }\n    return false;\n  };\n\n  const renderCell = (el) => {\n    const idx = el.rowIndex * 2 + el.columnIndex;\n    if (idx >= orders.length) {\n      return null;\n    }\n    return (\n      <div key={el.key} style={el.style}>\n        <OrderCard\n          refresh={refresh}\n          showBorder={(idx % 2 === 0)}\n          order={orders[idx]}\n          showAlert={show(orders[idx])}\n        />\n      </div>\n    );\n  };\n\n  const onCreateChange = (val) => {\n    setDateRangeFilters({\n      from: null,\n      to: null\n    });\n    params.set('placed', val);\n    history.push({ search: params.toString() });\n  };\n\n  return (\n    <div className={styles.container}>\n      <Header />\n      <div className={styles.content}>\n        <div className={cx('flexBetween', styles.section)}>\n          <Picker\n            label={getText(dateRangeFilters)}\n            onSelect={(e) => {\n              const isEmptyValue = Object.keys(e).length === 0;\n              setDateRangeFilters(e);\n              params.set('placed', !isEmptyValue ? 'custom' : 'all');\n              history.push({ search: params.toString() });\n            }}\n          />\n          <div className={styles.searchDiv}>\n            <Search\n              value={query}\n              placeholder=\"Search by order ID\"\n              className={styles.searchBar}\n              onChange={(e) => setQuery(e.target.value)}\n            />\n            <Button label=\"Search\" size=\"small\" primary={true} className={styles.Searchbutton} />\n          </div>\n        </div>\n        <StatusSelectionBar\n          tabClassName={styles.tabClassName}\n          className={styles.tabClass}\n          activeClass={styles.tabActive}\n          items={placedList}\n          onChange={onCreateChange}\n          active={place}\n        />\n        <div className={styles.filters}>\n          <Filters\n            onSelect={(e) => {\n              params.delete('state');\n              params.set('custom', e.join(','));\n              history.push({ search: params.toString() });\n            }}\n            selected={custom.length > 0 ? custom.split(',') : []}\n            reset={custom.length === 0}\n          />\n        </div>\n        <div className={styles.text}>\n          Orders List\n          {' '}\n          <span className={styles.span}>\n            (\n            {' '}\n            {orders.length}\n            {' '}\n            orders\n            )\n          </span>\n        </div>\n        {orders.length > 0 ? (\n          <InfiniteLoader\n            loadMoreRows={loadMore}\n            isRowLoaded={isLoaded}\n            rowCount={rowCount}\n            minimumBatchSize={10}\n          >\n            {({\n              onRowsRendered,\n              registerChild\n            }) => (\n              <Grid\n                onSectionRendered={onSectionRendered(onRowsRendered)}\n                ref={registerChild}\n                cellRenderer={renderCell}\n                columnCount={2}\n                columnWidth={(screenWidth / 2)}\n                height={height}\n                rowCount={Math.ceil(rowCount / 2)}\n                rowHeight={134}\n                width={screenWidth}\n              />\n            )}\n          </InfiniteLoader>\n        ) : (\n          <div className={styles.emptyOrders}>\n            <img src={emptyOrder} alt=\"\" />\n            <div className={styles.emptyProductText}>\n              You haven't received any orders yet!\n            </div>\n\n          </div>\n        )}\n      </div>\n      <Details open={!!id} id={id} />\n    </div>\n  );\n}\n\nexport default OrderList;\n"]},"metadata":{},"sourceType":"module"}