{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/containers/desktop/products/BulkProduct.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { Upload } from \"../../../components/desktop/product/bulk/Upload\";\nimport { Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow } from '@material-ui/core';\nimport { useShop } from \"../../../contexts\";\nimport { Button, Clickable } from 'phoenix-components';\nimport deleteIcon from \"../../../assets/images/address/delete.svg\";\nimport { UploadImage } from \"../../../components/desktop/product/bulk/UploadImage\";\nimport SnackBar from \"../../../services/snackbar\";\nimport Loader from \"../../../services/loader\";\nimport { mapProduct } from \"../../../components/desktop/product/bulk/utils\";\nimport { inSeries } from \"../../../utils/parallel\";\nimport _ from 'lodash';\nimport { Becca } from \"../../../api\";\nimport styles from \"./BulkProduct.module.css\";\n\nfunction BulkProduct() {\n  _s();\n\n  const [data, setData] = useState(null);\n  const shop = useShop();\n\n  const deleteRow = idx => () => {\n    setData(data.filter((_x, i) => i !== idx));\n  };\n\n  const onGetData = res => {\n    setData(res);\n  };\n\n  const onSetImage = idx => images => {\n    const item = data[idx];\n    item.images = images;\n    setData([...data]);\n  };\n\n  const onCreate = async () => {\n    Loader.show();\n\n    try {\n      const products = data.map(mapProduct);\n      await inSeries(_.chunk(products, 10), async chunk => {\n        try {\n          await Becca.createProductBulk(chunk);\n        } catch (e) {\n          SnackBar.showError(e);\n        }\n      });\n      SnackBar.show('products created successfully', 'success');\n      setData(null);\n    } catch (e) {\n      SnackBar.showError(e);\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }, data ? /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.table,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableContainer, {\n    component: Paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.topBar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.heading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 15\n    }\n  }, \"Preview\"), /*#__PURE__*/React.createElement(Button, {\n    disabled: !data.length,\n    label: \"Save and add products\",\n    onClick: onCreate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.tableContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 21\n    }\n  }, \"Images (upto 8)\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 21\n    }\n  }, \"Product Name\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 21\n    }\n  }, \"Category\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 21\n    }\n  }, \"Price\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 21\n    }\n  }, \"Strike-off Price\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 21\n    }\n  }, \"Availability\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 21\n    }\n  }, \"Action\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }\n  }, data.map((row, idx) => {\n    var _row$catalogs;\n\n    return /*#__PURE__*/React.createElement(TableRow, {\n      key: idx,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(UploadImage, {\n      onSetImage: onSetImage(idx),\n      item: row,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 23\n      }\n    }, row.name), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 23\n      }\n    }, row !== null && row !== void 0 && (_row$catalogs = row.catalogs) !== null && _row$catalogs !== void 0 && _row$catalogs.length ? row.catalogs[0] : ''), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 23\n      }\n    }, shop.currencySymbol, ' ', row.discountedAmount), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 23\n      }\n    }, shop.currencySymbol, ' ', row.amount || row.discountedAmount), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 23\n      }\n    }, row.availability), /*#__PURE__*/React.createElement(TableCell, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Clickable, {\n      onClick: deleteRow(idx),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: deleteIcon,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 27\n      }\n    }))));\n  })))))) : /*#__PURE__*/React.createElement(Upload, {\n    onChange: onGetData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }\n  }));\n}\n\n_s(BulkProduct, \"cuTuztDuBTfFtPcuQZIns0lQKdE=\", false, function () {\n  return [useShop];\n});\n\n_c = BulkProduct;\nBulkProduct.propTypes = {};\nBulkProduct.defaultProps = {};\nexport default BulkProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"BulkProduct\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/containers/desktop/products/BulkProduct.jsx"],"names":["React","useState","Upload","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","useShop","Button","Clickable","UploadImage","SnackBar","Loader","mapProduct","inSeries","_","Becca","styles","BulkProduct","data","setData","shop","deleteRow","idx","filter","_x","i","onGetData","res","onSetImage","images","item","onCreate","show","products","map","chunk","createProductBulk","e","showError","hide","table","topBar","heading","length","tableContainer","row","name","catalogs","currencySymbol","discountedAmount","amount","availability","deleteIcon","propTypes","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Upload } from 'components/desktop/product/bulk/Upload';\nimport {\n  Paper, Table, TableBody, TableCell, TableContainer, TableHead, TableRow\n} from '@material-ui/core';\nimport { useShop } from 'contexts';\nimport { Button, Clickable } from 'phoenix-components';\nimport deleteIcon from 'assets/images/address/delete.svg';\nimport { UploadImage } from 'components/desktop/product/bulk/UploadImage';\nimport SnackBar from 'services/snackbar';\nimport Loader from 'services/loader';\nimport { mapProduct } from 'components/desktop/product/bulk/utils';\nimport { inSeries } from 'utils/parallel';\nimport _ from 'lodash';\nimport { Becca } from 'api';\nimport styles from './BulkProduct.module.css';\n\nfunction BulkProduct() {\n  const [data, setData] = useState(null);\n  const shop = useShop();\n\n  const deleteRow = idx => () => {\n    setData(data.filter((_x, i) => i !== idx));\n  };\n\n  const onGetData = res => {\n    setData(res);\n  };\n\n  const onSetImage = idx => (images) => {\n    const item = data[idx];\n    item.images = images;\n    setData([...data]);\n  };\n\n  const onCreate = async () => {\n    Loader.show();\n    try {\n      const products = data.map(mapProduct);\n      await inSeries(_.chunk(products, 10), async (chunk) => {\n        try {\n          await Becca.createProductBulk(chunk);\n        } catch (e) {\n          SnackBar.showError(e);\n        }\n      });\n      SnackBar.show('products created successfully', 'success');\n      setData(null);\n    } catch (e) {\n      SnackBar.showError(e);\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  return (\n    <div>\n      {data ? (\n        <div className={styles.table}>\n          <TableContainer component={Paper}>\n            <div className={styles.topBar}>\n              <div className={styles.heading}>Preview</div>\n              <Button disabled={!data.length} label=\"Save and add products\" onClick={onCreate} />\n            </div>\n            <div className={styles.tableContainer}>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <TableCell>Images (upto 8)</TableCell>\n                    <TableCell>Product Name</TableCell>\n                    <TableCell>Category</TableCell>\n                    <TableCell>Price</TableCell>\n                    <TableCell>Strike-off Price</TableCell>\n                    <TableCell>Availability</TableCell>\n                    <TableCell>Action</TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {data.map((row, idx) => (\n                    <TableRow key={idx}>\n                      <TableCell>\n                        <UploadImage onSetImage={onSetImage(idx)} item={row} />\n                      </TableCell>\n                      <TableCell>{row.name}</TableCell>\n                      <TableCell>{row?.catalogs?.length ? row.catalogs[0] : ''}</TableCell>\n                      <TableCell>\n                        {shop.currencySymbol}\n                        {' '}\n                        {row.discountedAmount}\n                      </TableCell>\n                      <TableCell>\n                        {shop.currencySymbol}\n                        {' '}\n                        {row.amount || row.discountedAmount}\n                      </TableCell>\n                      <TableCell>\n                        {row.availability}\n                      </TableCell>\n                      <TableCell>\n                        <Clickable onClick={deleteRow(idx)}>\n                          <img src={deleteIcon} alt=\"\" />\n                        </Clickable>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </TableContainer>\n        </div>\n      ) : (\n        <Upload onChange={onGetData} />\n      )}\n    </div>\n  );\n}\n\nBulkProduct.propTypes = {};\n\nBulkProduct.defaultProps = {};\n\nexport default BulkProduct;\n"]},"metadata":{},"sourceType":"module"}