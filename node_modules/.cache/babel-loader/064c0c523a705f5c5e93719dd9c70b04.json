{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/containers/products/Catalog/View.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { useInfiniteProducts } from \"../../../hooks\";\nimport { useHistory, useParams } from 'react-router-dom';\nimport { Loading } from \"../../../components/shared/Loading\";\nimport { useDesktop } from \"../../../contexts\";\nimport AddIcon from \"../../../assets/images/products/catalog/add.svg\";\nimport ShareIcon from \"../../../assets/images/products/catalog/share.svg\"; // import { SideDrawer } from 'components/shared/SideDrawer';\n\nimport EditIcon from \"../../../assets/images/products/catalog/edit.svg\";\nimport SuccessIcon from \"../../../assets/images/products/catalog/success.svg\";\nimport { useCustomDomain, useIsOnCustomDomain, useRefreshShop, useShop } from \"../../../contexts/userContext\";\nimport { Avatar } from '@material-ui/core';\nimport ButtonComponent from \"../../profile/ButtonComponent\";\nimport { Grid, InfiniteLoader } from 'react-virtualized';\nimport { ProductsDrawer } from \"../../../components/shared/ProductsDrawer\";\nimport Alert from \"../../../components/shared/alert/Alert\";\nimport { useToggle } from \"../../../hooks/common\";\nimport SnackBar from \"../../../services/snackbar\";\nimport { Becca } from \"../../../api\";\nimport { get } from 'lodash';\nimport Loader from \"../../../services/loader\";\nimport { shareCatalog } from \"../../../utils/share\";\nimport { share } from \"../../../utils\";\nimport { Switch, Button as Btn } from 'phoenix-components';\nimport styles from \"./View.module.css\";\nimport { ProductCard } from \"./Card\";\nimport { Add } from \"./Add\";\n\nfunction View() {\n  _s();\n\n  var _catalog$caption, _catalog$caption2;\n\n  const {\n    catalogs = [],\n    slug,\n    name\n  } = useShop();\n  const refresh = useRefreshShop();\n  const [add, setAdd] = useToggle();\n  const [edit, setEdit] = useToggle();\n  const isDesktop = useDesktop();\n  const [showAlert, setShowAlert] = useToggle();\n  const {\n    id\n  } = useParams();\n  const catalog = catalogs.find(x => x._id === id);\n  const [caption, setCaption] = useState((catalog === null || catalog === void 0 ? void 0 : catalog.caption) || '');\n  const history = useHistory();\n  const isCustomDomain = useIsOnCustomDomain();\n  const domain = useCustomDomain();\n  const filters = {\n    catalogs: {\n      $in: [catalog === null || catalog === void 0 ? void 0 : catalog.caption]\n    },\n    status: {\n      $ne: 'deleted'\n    }\n  };\n  const [products, loadMore, hasMore, loading] = useInfiniteProducts(filters, {\n    createdAt: -1\n  });\n  const isEmpty = products.length === 0 && loading;\n  const [url, setUrl] = useState((catalog === null || catalog === void 0 ? void 0 : catalog.url) || '');\n  const getProductImage = get(products, '[0].images.[0].url', (catalog === null || catalog === void 0 ? void 0 : catalog.url) || '');\n  const rowCount = hasMore ? 10000 : products.length;\n\n  const isLoaded = i => !!products[i];\n\n  const height = isDesktop ? window.screen.height - 109 - 59 : window.screen.height - 109 - 36 - 45 - 16;\n  const cellWidth = isDesktop ? (window.screen.width - 272 - 32) / 4 : (window.screen.width - 32) / 2;\n  const status = (catalog === null || catalog === void 0 ? void 0 : catalog.status) || 'live';\n\n  const onClose = async (ids = []) => {\n    if (ids.length === 0) {\n      refresh();\n      setAdd();\n      return;\n    }\n\n    try {\n      Loader.show();\n      await Becca.addProductsToCatalog({\n        _id: id,\n        skuIds: ids\n      });\n      setShowAlert();\n    } catch (e) {\n      SnackBar.show('something went wrong, try again', 'error');\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const onAlertClose = () => {\n    setAdd();\n    refresh();\n  };\n\n  const updateShop = async status => {\n    if (caption.length === 0) {\n      SnackBar.show('Please Add Name', 'error');\n      return;\n    }\n\n    try {\n      await Becca.updateCatalog({\n        url: url || getProductImage,\n        caption,\n        _id: id,\n        status\n      });\n      SnackBar.show('Collection Updated Successfully');\n      refresh();\n\n      if (!status) {\n        history.goBack();\n      }\n\n      setUrl('');\n      setCaption('');\n    } catch (exception) {\n      SnackBar.showError(exception);\n    }\n  };\n\n  if (isEmpty) {\n    return /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 12\n      }\n    });\n  } // eslint-disable-next-line react/no-multi-comp\n\n\n  const renderCell = el => {\n    const idx = el.rowIndex * 2 + el.columnIndex;\n\n    if (idx >= products.length) {\n      return null;\n    }\n\n    const product = products[idx];\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: el.key,\n      style: el.style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(ProductCard, {\n      product: product,\n      refresh: refresh,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }\n    }));\n  };\n\n  const onSectionRendered = onRowsRendered => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 2 + columnStartIndex;\n    const stopIndex = rowStopIndex * 2 + columnStopIndex;\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  const getSign = () => {\n    if (hasMore) {\n      if (products.length > 15) {\n        return '+';\n      }\n\n      return '';\n    }\n\n    return '';\n  };\n\n  const shareToUser = e => {\n    e.stopPropagation();\n    e.preventDefault();\n    share(`Hello\n\nWe are now selling online. Please visit my WINDO Shop Catalog at\n${shareCatalog(catalog === null || catalog === void 0 ? void 0 : catalog.caption, slug, isCustomDomain, domain)} to buy my products.\n\nThank you\n${name}`);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, !isDesktop && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.catalogBlock,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    className: styles.img,\n    variant: \"rounded\",\n    src: url || getProductImage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, catalog !== null && catalog !== void 0 && catalog.caption ? catalog === null || catalog === void 0 ? void 0 : (_catalog$caption = catalog.caption) === null || _catalog$caption === void 0 ? void 0 : _catalog$caption.charAt(0) : '#'), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.middle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 15\n    }\n  }, catalog === null || catalog === void 0 ? void 0 : catalog.caption), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.shareFlex,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    onClick: shareToUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.shareImg,\n    src: ShareIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 19\n    }\n  }, \" Share Collection\")), /*#__PURE__*/React.createElement(Switch, {\n    active: status === 'live',\n    onChange: () => updateShop(status === 'live' ? 'unlive' : 'live'),\n    value: status === 'live',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.edit,\n    src: EditIcon,\n    onClick: setEdit,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flexBetween marginSTopBottom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ButtonComponent, {\n    style: styles.catLabel,\n    text: \"Total Products\",\n    color: \"secondary\",\n    onClick: () => {},\n    endIcon: /*#__PURE__*/React.createElement(\"span\", {\n      className: styles.catCount,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 19\n      }\n    }, `${products.length}${getSign()}`, ' '),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Btn, {\n    className: styles.catLabel1,\n    onClick: setAdd,\n    label: \"Add Products\",\n    size: \"small\",\n    primary: false,\n    startIcon: AddIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(InfiniteLoader, {\n    loadMoreRows: loadMore,\n    isRowLoaded: isLoaded,\n    rowCount: rowCount,\n    minimumBatchSize: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }\n  }, ({\n    onRowsRendered,\n    registerChild\n  }) => /*#__PURE__*/React.createElement(Grid, {\n    onSectionRendered: onSectionRendered(onRowsRendered),\n    ref: registerChild,\n    cellRenderer: renderCell,\n    columnCount: 2,\n    columnWidth: cellWidth,\n    height: height,\n    rowCount: Math.ceil(rowCount / (isDesktop ? 4 : 2)),\n    rowHeight: 172,\n    style: {\n      display: 'flex'\n    },\n    width: window.screen.width,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 17\n    }\n  })), add && /*#__PURE__*/React.createElement(ProductsDrawer, {\n    filters: {\n      catalogs: {\n        $nin: [catalog === null || catalog === void 0 ? void 0 : catalog.caption]\n      }\n    },\n    initial: [],\n    title: \"Add Products\",\n    btnText: \"Add\",\n    onClose: onClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 15\n    }\n  }), edit && /*#__PURE__*/React.createElement(Add, {\n    url: url || getProductImage,\n    caption: caption,\n    setUrl: setUrl,\n    catalogs: catalogs,\n    setCaption: setCaption,\n    updateShop: updateShop,\n    onBack: setEdit,\n    type: \"update\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 15\n    }\n  })), showAlert && /*#__PURE__*/React.createElement(Alert, {\n    text: \"Products added Successfully\",\n    btnText: \"Ok\",\n    icon: SuccessIcon,\n    onClick: onAlertClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 13\n    }\n  })), isDesktop && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.catalogBlock1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    className: styles.img,\n    variant: \"rounded\",\n    src: url || getProductImage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 13\n    }\n  }, catalog !== null && catalog !== void 0 && catalog.caption ? catalog === null || catalog === void 0 ? void 0 : (_catalog$caption2 = catalog.caption) === null || _catalog$caption2 === void 0 ? void 0 : _catalog$caption2.charAt(0) : '#'), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.middle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 15\n    }\n  }, catalog === null || catalog === void 0 ? void 0 : catalog.caption), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.shareFlex,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    onClick: shareToUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.shareImg,\n    src: ShareIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 19\n    }\n  }, \" Share Collection\")), /*#__PURE__*/React.createElement(Switch, {\n    active: status === 'live',\n    onChange: () => updateShop(status === 'live' ? 'unlive' : 'live'),\n    value: status === 'live',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.edit,\n    src: EditIcon,\n    onClick: setEdit,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.margin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ButtonComponent, {\n    style: styles.catLabelDesk,\n    text: \"Total Products\",\n    color: \"secondary\",\n    onClick: () => {},\n    endIcon: /*#__PURE__*/React.createElement(\"span\", {\n      className: styles.catCount,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 19\n      }\n    }, `${products.length}${getSign()}`, ' '),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Btn, {\n    className: styles.catLabelDesk1,\n    onClick: setAdd,\n    label: \"Add Products\",\n    size: \"small\",\n    primary: false,\n    startIcon: AddIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(InfiniteLoader, {\n    loadMoreRows: loadMore,\n    isRowLoaded: isLoaded,\n    rowCount: rowCount,\n    minimumBatchSize: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }\n  }, ({\n    onRowsRendered,\n    registerChild\n  }) => /*#__PURE__*/React.createElement(Grid, {\n    onSectionRendered: onSectionRendered(onRowsRendered),\n    ref: registerChild,\n    cellRenderer: renderCell,\n    columnCount: 4,\n    columnWidth: cellWidth,\n    height: height,\n    rowCount: Math.ceil(rowCount / (isDesktop ? 4 : 2)),\n    rowHeight: 172,\n    style: {\n      display: 'flex'\n    },\n    width: window.screen.width,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 17\n    }\n  })), add && /*#__PURE__*/React.createElement(ProductsDrawer, {\n    filters: {\n      catalogs: {\n        $nin: [catalog === null || catalog === void 0 ? void 0 : catalog.caption]\n      }\n    },\n    initial: [],\n    title: \"Add Products\",\n    btnText: \"Add\",\n    onClose: onClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 15\n    }\n  }), edit && /*#__PURE__*/React.createElement(Add, {\n    url: url || getProductImage,\n    caption: caption,\n    setUrl: setUrl,\n    catalogs: catalogs,\n    setCaption: setCaption,\n    updateShop: updateShop,\n    onBack: setEdit,\n    type: \"update\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 15\n    }\n  })), showAlert && /*#__PURE__*/React.createElement(Alert, {\n    text: \"Whoopee, product added successfully!\",\n    btnText: \"Ok\",\n    icon: SuccessIcon,\n    onClick: onAlertClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 13\n    }\n  })));\n}\n\n_s(View, \"SYr/8b5yxQCoRCrkwMbOf8u+smA=\", false, function () {\n  return [useShop, useRefreshShop, useToggle, useToggle, useDesktop, useToggle, useParams, useHistory, useIsOnCustomDomain, useCustomDomain, useInfiniteProducts];\n});\n\n_c = View;\nexport default View;\n\nvar _c;\n\n$RefreshReg$(_c, \"View\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/containers/products/Catalog/View.jsx"],"names":["React","useState","useInfiniteProducts","useHistory","useParams","Loading","useDesktop","useCustomDomain","useIsOnCustomDomain","useRefreshShop","useShop","Avatar","ButtonComponent","Grid","InfiniteLoader","ProductsDrawer","Alert","useToggle","SnackBar","Becca","get","Loader","shareCatalog","share","Switch","Button","Btn","styles","ProductCard","Add","View","catalogs","slug","name","refresh","add","setAdd","edit","setEdit","isDesktop","showAlert","setShowAlert","id","catalog","find","x","_id","caption","setCaption","history","isCustomDomain","domain","filters","$in","status","$ne","products","loadMore","hasMore","loading","createdAt","isEmpty","length","url","setUrl","getProductImage","rowCount","isLoaded","i","height","window","screen","cellWidth","width","onClose","ids","show","addProductsToCatalog","skuIds","e","hide","onAlertClose","updateShop","updateCatalog","goBack","exception","showError","renderCell","el","idx","rowIndex","columnIndex","product","key","style","onSectionRendered","onRowsRendered","columnStartIndex","columnStopIndex","rowStartIndex","rowStopIndex","startIndex","stopIndex","getSign","shareToUser","stopPropagation","preventDefault","paper","catalogBlock","img","charAt","middle","shareFlex","shareImg","ShareIcon","EditIcon","container","catLabel","catCount","catLabel1","AddIcon","registerChild","Math","ceil","display","$nin","SuccessIcon","catalogBlock1","margin","catLabelDesk","catLabelDesk1"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useInfiniteProducts } from 'hooks';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { Loading } from 'components/shared/Loading';\nimport { useDesktop } from 'contexts';\nimport AddIcon from 'assets/images/products/catalog/add.svg';\nimport ShareIcon from 'assets/images/products/catalog/share.svg';\n// import { SideDrawer } from 'components/shared/SideDrawer';\nimport EditIcon from 'assets/images/products/catalog/edit.svg';\nimport SuccessIcon from 'assets/images/products/catalog/success.svg';\nimport {\n  useCustomDomain, useIsOnCustomDomain, useRefreshShop, useShop\n} from 'contexts/userContext';\nimport {\n  Avatar,\n} from '@material-ui/core';\nimport ButtonComponent from 'containers/profile/ButtonComponent';\nimport { Grid, InfiniteLoader } from 'react-virtualized';\nimport { ProductsDrawer } from 'components/shared/ProductsDrawer';\nimport Alert from 'components/shared/alert/Alert';\nimport { useToggle } from 'hooks/common';\nimport SnackBar from 'services/snackbar';\nimport { Becca } from 'api/index';\nimport { get } from 'lodash';\nimport Loader from 'services/loader';\nimport { shareCatalog } from 'utils/share';\nimport { share } from 'utils';\nimport { Switch, Button as Btn } from 'phoenix-components';\nimport styles from './View.module.css';\nimport { ProductCard } from './Card';\nimport { Add } from './Add';\n\nfunction View() {\n  const { catalogs = [], slug, name } = useShop();\n  const refresh = useRefreshShop();\n  const [add, setAdd] = useToggle();\n  const [edit, setEdit] = useToggle();\n  const isDesktop = useDesktop();\n  const [showAlert, setShowAlert] = useToggle();\n  const { id } = useParams();\n  const catalog = catalogs.find(x => x._id === id);\n  const [caption, setCaption] = useState(catalog?.caption || '');\n  const history = useHistory();\n  const isCustomDomain = useIsOnCustomDomain();\n  const domain = useCustomDomain();\n\n  const filters = {\n    catalogs: { $in: [catalog?.caption] },\n    status: {\n      $ne: 'deleted',\n    },\n  };\n\n  const [products, loadMore, hasMore, loading] = useInfiniteProducts(filters, { createdAt: -1 });\n\n  const isEmpty = products.length === 0 && loading;\n\n  const [url, setUrl] = useState(catalog?.url || '');\n\n  const getProductImage = get(products, '[0].images.[0].url', catalog?.url || '');\n\n  const rowCount = hasMore ? 10000 : products.length;\n\n  const isLoaded = i => !!products[i];\n\n  const height = isDesktop ? window.screen.height - 109 - 59 : window.screen.height - 109 - 36 - 45 - 16;\n  const cellWidth = isDesktop ? (window.screen.width - 272 - 32) / 4 : (window.screen.width - 32) / 2;\n\n  const status = (catalog?.status || 'live');\n\n  const onClose = async (ids = []) => {\n    if (ids.length === 0) {\n      refresh();\n      setAdd();\n      return;\n    }\n    try {\n      Loader.show();\n      await Becca.addProductsToCatalog({ _id: id, skuIds: ids });\n      setShowAlert();\n    } catch (e) {\n      SnackBar.show('something went wrong, try again', 'error');\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const onAlertClose = () => {\n    setAdd();\n    refresh();\n  };\n\n  const updateShop = async (status) => {\n    if (caption.length === 0) {\n      SnackBar.show('Please Add Name', 'error');\n      return;\n    }\n    try {\n      await Becca.updateCatalog({\n        url: url || getProductImage,\n        caption,\n        _id: id,\n        status\n      });\n      SnackBar.show('Collection Updated Successfully');\n      refresh();\n      if (!status) {\n        history.goBack();\n      }\n      setUrl('');\n      setCaption('');\n    } catch (exception) {\n      SnackBar.showError(exception);\n    }\n  };\n\n  if (isEmpty) {\n    return <Loading />;\n  }\n\n  // eslint-disable-next-line react/no-multi-comp\n  const renderCell = (el) => {\n    const idx = el.rowIndex * 2 + el.columnIndex;\n    if (idx >= products.length) {\n      return null;\n    }\n    const product = products[idx];\n    return (\n      <div key={el.key} style={el.style}>\n        <ProductCard product={product} refresh={refresh} />\n      </div>\n    );\n  };\n\n  const onSectionRendered = (onRowsRendered) => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 2 + columnStartIndex;\n    const stopIndex = rowStopIndex * 2 + columnStopIndex;\n\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  const getSign = () => {\n    if (hasMore) {\n      if (products.length > 15) {\n        return '+';\n      }\n      return '';\n    }\n    return '';\n  };\n\n  const shareToUser = e => {\n    e.stopPropagation();\n    e.preventDefault();\n    share(`Hello\n\nWe are now selling online. Please visit my WINDO Shop Catalog at\n${shareCatalog(catalog?.caption, slug, isCustomDomain, domain)} to buy my products.\n\nThank you\n${name}`);\n  };\n\n  return (\n    <>\n      {!isDesktop && (\n        <div className={styles.paper}>\n          <div className={styles.catalogBlock}>\n            <Avatar className={styles.img} variant=\"rounded\" src={url || getProductImage}>\n              {catalog?.caption ? catalog?.caption?.charAt(0) : '#'}\n            </Avatar>\n            <div className={styles.middle}>\n              <div className={styles.name}>{catalog?.caption}</div>\n              <div className={styles.shareFlex}>\n                <span onClick={shareToUser}>\n                  <img className={styles.shareImg} src={ShareIcon} alt=\"\" />\n                  <span> Share Collection</span>\n                </span>\n                <Switch\n                  active={status === 'live'}\n                  onChange={() => updateShop(status === 'live' ? 'unlive' : 'live')}\n                  value={status === 'live'}\n                />\n              </div>\n            </div>\n            <img\n              className={styles.edit}\n              src={EditIcon}\n              onClick={setEdit}\n              alt=\"\" />\n          </div>\n          <div className={styles.container}>\n            <div className=\"flexBetween marginSTopBottom\">\n              <ButtonComponent\n                style={styles.catLabel}\n                text=\"Total Products\"\n                color=\"secondary\"\n                onClick={() => {}}\n                endIcon={(\n                  <span className={styles.catCount}>\n                    {`${products.length}${getSign()}`}\n                    {' '}\n                  </span>\n                )}\n              />\n              <Btn\n                className={styles.catLabel1}\n                onClick={setAdd}\n                label=\"Add Products\"\n                size=\"small\"\n                primary={false}\n                startIcon={AddIcon}\n              />\n            </div>\n            <InfiniteLoader\n              loadMoreRows={loadMore}\n              isRowLoaded={isLoaded}\n              rowCount={rowCount}\n              minimumBatchSize={10}\n            >\n              {({\n                onRowsRendered,\n                registerChild\n              }) => (\n                <Grid\n                  onSectionRendered={onSectionRendered(onRowsRendered)}\n                  ref={registerChild}\n                  cellRenderer={renderCell}\n                  columnCount={2}\n                  columnWidth={cellWidth}\n                  height={height}\n                  rowCount={Math.ceil(rowCount / (isDesktop ? 4 : 2))}\n                  rowHeight={172}\n                  style={{ display: 'flex' }}\n                  width={window.screen.width}\n                />\n              )}\n            </InfiniteLoader>\n            {add && (\n              <ProductsDrawer\n                filters={{ catalogs: { $nin: [catalog?.caption] } }}\n                initial={[]}\n                title=\"Add Products\"\n                btnText=\"Add\"\n                onClose={onClose}\n              />\n            )}\n            {edit && (\n              <Add\n                url={url || getProductImage}\n                caption={caption}\n                setUrl={setUrl}\n                catalogs={catalogs}\n                setCaption={setCaption}\n                updateShop={updateShop}\n                onBack={setEdit}\n                type=\"update\"\n              />\n            )}\n          </div>\n          {showAlert && (\n            <Alert\n              text=\"Products added Successfully\"\n              btnText=\"Ok\"\n              icon={SuccessIcon}\n              onClick={onAlertClose}\n            />\n          )}\n        </div>\n      )}\n      {isDesktop && (\n        <div className={styles.paper}>\n          <div className={styles.catalogBlock1}>\n            <Avatar className={styles.img} variant=\"rounded\" src={url || getProductImage}>\n              {catalog?.caption ? catalog?.caption?.charAt(0) : '#'}\n            </Avatar>\n            <div className={styles.middle}>\n              <div className={styles.name}>{catalog?.caption}</div>\n              <div className={styles.shareFlex}>\n                <span onClick={shareToUser}>\n                  <img className={styles.shareImg} src={ShareIcon} alt=\"\" />\n                  <span> Share Collection</span>\n                </span>\n                <Switch\n                  active={status === 'live'}\n                  onChange={() => updateShop(status === 'live' ? 'unlive' : 'live')}\n                  value={status === 'live'}\n                />\n              </div>\n            </div>\n            <img\n              className={styles.edit}\n              src={EditIcon}\n              onClick={setEdit}\n              alt=\"\" />\n          </div>\n          <div className={styles.container}>\n            <div className={styles.margin}>\n              <ButtonComponent\n                style={styles.catLabelDesk}\n                text=\"Total Products\"\n                color=\"secondary\"\n                onClick={() => {}}\n                endIcon={(\n                  <span className={styles.catCount}>\n                    {`${products.length}${getSign()}`}\n                    {' '}\n                  </span>\n                )}\n              />\n              <Btn\n                className={styles.catLabelDesk1}\n                onClick={setAdd}\n                label=\"Add Products\"\n                size=\"small\"\n                primary={false}\n                startIcon={AddIcon}\n              />\n            </div>\n            <InfiniteLoader\n              loadMoreRows={loadMore}\n              isRowLoaded={isLoaded}\n              rowCount={rowCount}\n              minimumBatchSize={10}\n            >\n              {({\n                onRowsRendered,\n                registerChild\n              }) => (\n                <Grid\n                  onSectionRendered={onSectionRendered(onRowsRendered)}\n                  ref={registerChild}\n                  cellRenderer={renderCell}\n                  columnCount={4}\n                  columnWidth={cellWidth}\n                  height={height}\n                  rowCount={Math.ceil(rowCount / (isDesktop ? 4 : 2))}\n                  rowHeight={172}\n                  style={{ display: 'flex' }}\n                  width={window.screen.width}\n                />\n              )}\n            </InfiniteLoader>\n            {add && (\n              <ProductsDrawer\n                filters={{ catalogs: { $nin: [catalog?.caption] } }}\n                initial={[]}\n                title=\"Add Products\"\n                btnText=\"Add\"\n                onClose={onClose}\n              />\n            )}\n            {edit && (\n              <Add\n                url={url || getProductImage}\n                caption={caption}\n                setUrl={setUrl}\n                catalogs={catalogs}\n                setCaption={setCaption}\n                updateShop={updateShop}\n                onBack={setEdit}\n                type=\"update\" />\n            )}\n          </div>\n          {showAlert && (\n            <Alert\n              text=\"Whoopee, product added successfully!\"\n              btnText=\"Ok\"\n              icon={SuccessIcon}\n              onClick={onAlertClose}\n            />\n          )}\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default View;\n"]},"metadata":{},"sourceType":"module"}