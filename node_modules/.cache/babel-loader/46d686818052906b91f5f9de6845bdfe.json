{"ast":null,"code":"import _ from 'lodash';\nimport * as Yup from 'yup';\nexport const FEE_TYPES = [{\n  name: 'Additional Fee',\n  value: 'additional'\n}, {\n  name: 'Discount',\n  value: 'discount'\n}];\nexport const VALUE_TYPES = [{\n  name: 'Percentage',\n  value: 'percentage'\n}, {\n  name: 'Flat',\n  value: 'flat'\n}];\nexport const schema = Yup.array().of(Yup.object({\n  type: Yup.string().oneOf(['cod', 'online', 'customPayment']).required(),\n  value: Yup.string().required(),\n  enabled: Yup.bool().required(),\n  cartValue: Yup.object({\n    min: Yup.number().nullable().notRequired(),\n    max: Yup.number().nullable().notRequired().min(Yup.ref('min'), 'Should be greater than minimum cart value')\n  }).notRequired(),\n  advanced: Yup.object({\n    feeType: Yup.string().oneOf(['additional', 'discount']).nullable().notRequired(),\n    type: Yup.string().oneOf(['percentage', 'flat']).nullable().notRequired(),\n    value: Yup.number().nullable().notRequired(),\n    maxValue: Yup.number().nullable().notRequired()\n  }),\n  partial: Yup.object({\n    type: Yup.string().nullable().notRequired(),\n    value: Yup.number().nullable().notRequired(),\n    maxValue: Yup.number().nullable().notRequired()\n  })\n}));\nexport const marshall = payload => payload.map(item => {\n  const {\n    advanced,\n    ...other\n  } = item;\n  return { ...other,\n    advanced: _.isEmpty(advanced === null || advanced === void 0 ? void 0 : advanced.feeType) ? undefined : advanced\n  };\n});\nexport const getRuleSubString = (currency, rule) => {\n  var _rule$cartValue, _rule$cartValue2, _rule$advanced, _rule$advanced2, _rule$partial, _rule$partial2, _rule$cartValue3, _rule$cartValue4, _rule$advanced3;\n\n  if (!(rule !== null && rule !== void 0 && (_rule$cartValue = rule.cartValue) !== null && _rule$cartValue !== void 0 && _rule$cartValue.min) && !(rule !== null && rule !== void 0 && (_rule$cartValue2 = rule.cartValue) !== null && _rule$cartValue2 !== void 0 && _rule$cartValue2.max) && !(rule !== null && rule !== void 0 && (_rule$advanced = rule.advanced) !== null && _rule$advanced !== void 0 && _rule$advanced.value) && !(rule !== null && rule !== void 0 && (_rule$advanced2 = rule.advanced) !== null && _rule$advanced2 !== void 0 && _rule$advanced2.maxValue) && !(rule !== null && rule !== void 0 && (_rule$partial = rule.partial) !== null && _rule$partial !== void 0 && _rule$partial.value) && !(rule !== null && rule !== void 0 && (_rule$partial2 = rule.partial) !== null && _rule$partial2 !== void 0 && _rule$partial2.maxValue)) {\n    return 'No rules set';\n  }\n\n  const str = [];\n\n  if (rule !== null && rule !== void 0 && (_rule$cartValue3 = rule.cartValue) !== null && _rule$cartValue3 !== void 0 && _rule$cartValue3.min) {\n    str.push(`Min: ${currency} ${rule.cartValue.min}`);\n  }\n\n  if (rule !== null && rule !== void 0 && (_rule$cartValue4 = rule.cartValue) !== null && _rule$cartValue4 !== void 0 && _rule$cartValue4.max) {\n    str.push(`Max: ${currency} ${rule.cartValue.max}`);\n  }\n\n  if (rule !== null && rule !== void 0 && (_rule$advanced3 = rule.advanced) !== null && _rule$advanced3 !== void 0 && _rule$advanced3.value) {\n    var _rule$advanced4, _rule$advanced5, _rule$advanced6;\n\n    const value = rule === null || rule === void 0 ? void 0 : (_rule$advanced4 = rule.advanced) === null || _rule$advanced4 === void 0 ? void 0 : _rule$advanced4.value;\n    const type = (rule === null || rule === void 0 ? void 0 : (_rule$advanced5 = rule.advanced) === null || _rule$advanced5 === void 0 ? void 0 : _rule$advanced5.feeType) === 'additional' ? 'Additional' : 'Discount';\n    const valueType = rule === null || rule === void 0 ? void 0 : (_rule$advanced6 = rule.advanced) === null || _rule$advanced6 === void 0 ? void 0 : _rule$advanced6.type;\n    str.push(`${type}: ${valueType === 'percentage' ? '' : `${currency} `}${value}${valueType === 'percentage' ? '%' : ''}`);\n  }\n\n  return str.join(', ');\n};","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/containers/profile/checkout/paymentRuleUtils.js"],"names":["_","Yup","FEE_TYPES","name","value","VALUE_TYPES","schema","array","of","object","type","string","oneOf","required","enabled","bool","cartValue","min","number","nullable","notRequired","max","ref","advanced","feeType","maxValue","partial","marshall","payload","map","item","other","isEmpty","undefined","getRuleSubString","currency","rule","str","push","valueType","join"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport * as Yup from 'yup';\n\nexport const FEE_TYPES = [\n  { name: 'Additional Fee', value: 'additional' },\n  { name: 'Discount', value: 'discount' },\n];\n\nexport const VALUE_TYPES = [\n  { name: 'Percentage', value: 'percentage' },\n  { name: 'Flat', value: 'flat' },\n];\n\nexport const schema = Yup.array()\n  .of(\n    Yup.object({\n      type: Yup.string()\n        .oneOf(['cod', 'online', 'customPayment'])\n        .required(),\n      value: Yup.string()\n        .required(),\n      enabled: Yup.bool()\n        .required(),\n      cartValue: Yup.object({\n        min: Yup.number()\n          .nullable()\n          .notRequired(),\n        max: Yup.number()\n          .nullable()\n          .notRequired()\n          .min(Yup.ref('min'), 'Should be greater than minimum cart value'),\n      })\n        .notRequired(),\n      advanced: Yup.object({\n        feeType: Yup.string()\n          .oneOf(['additional', 'discount'])\n          .nullable()\n          .notRequired(),\n        type: Yup.string()\n          .oneOf(['percentage', 'flat'])\n          .nullable()\n          .notRequired(),\n        value: Yup.number()\n          .nullable()\n          .notRequired(),\n        maxValue: Yup.number()\n          .nullable()\n          .notRequired(),\n      }),\n      partial: Yup.object({\n        type: Yup.string()\n          .nullable()\n          .notRequired(),\n        value: Yup.number()\n          .nullable()\n          .notRequired(),\n        maxValue: Yup.number()\n          .nullable()\n          .notRequired(),\n      }),\n    })\n  );\n\nexport const marshall = (payload) => payload.map(item => {\n  const {\n    advanced,\n    ...other\n  } = item;\n  return {\n    ...other,\n    advanced: _.isEmpty(advanced?.feeType) ? undefined : advanced,\n  };\n});\n\nexport const getRuleSubString = (currency, rule) => {\n  if (!rule?.cartValue?.min && !rule?.cartValue?.max && !rule?.advanced?.value\n    && !rule?.advanced?.maxValue && !rule?.partial?.value && !rule?.partial?.maxValue) {\n    return 'No rules set';\n  }\n  const str = [];\n\n  if (rule?.cartValue?.min) {\n    str.push(`Min: ${currency} ${rule.cartValue.min}`);\n  }\n\n  if (rule?.cartValue?.max) {\n    str.push(`Max: ${currency} ${rule.cartValue.max}`);\n  }\n\n  if (rule?.advanced?.value) {\n    const value = rule?.advanced?.value;\n    const type = rule?.advanced?.feeType === 'additional' ? 'Additional' : 'Discount';\n    const valueType = rule?.advanced?.type;\n    str.push(\n      `${type}: ${valueType === 'percentage' ? '' : `${currency} `}${value}${valueType === 'percentage' ? '%' : ''}`\n    );\n  }\n  return str.join(', ');\n};\n"]},"metadata":{},"sourceType":"module"}