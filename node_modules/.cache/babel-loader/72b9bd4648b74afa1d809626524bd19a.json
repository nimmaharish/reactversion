{"ast":null,"code":"var _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { Snitch } from \"../api\";\nimport Snackbar from \"../services/snackbar\";\nimport Loader from \"../services/loader\";\nexport function useCoupon(id) {\n  _s();\n\n  const [coupon, setCoupon] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  const refresh = async () => {\n    if (!id) {\n      return;\n    }\n\n    if (loading) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setCoupon(await Snitch.getCoupon(id));\n    } catch (e) {\n      console.error(e);\n      Snackbar.show('error occurred', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    refresh();\n  }, [id]);\n  return [coupon, refresh, loading];\n}\n\n_s(useCoupon, \"AMHdoSedCvaVXd7x/W1hLL2yTqQ=\");\n\nexport function useInfiniteCoupons(filters = {}, sorts = {}) {\n  _s2();\n\n  const [coupons, setCoupons] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [page, setPage] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n\n  const loadMore = async ({\n    stopIndex = 10\n  } = {}) => {\n    if (loading) {\n      return;\n    }\n\n    const newPage = Math.floor(stopIndex / 10);\n\n    if (newPage <= page) {\n      return;\n    }\n\n    if (!hasMore) {\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      if (page === 0) {\n        Loader.show();\n      }\n\n      const data = await Snitch.getAllCoupons(page, filters, sorts);\n      setCoupons([...coupons, ...data]);\n\n      if (data.length === 0) {\n        setHasMore(false);\n      }\n\n      setPage(page + 1);\n    } catch (e) {\n      console.error(e);\n      Snackbar.show('Error Occurred', 'error');\n    } finally {\n      Loader.hide();\n      setLoading(false);\n    }\n  };\n\n  const refresh = async () => {\n    try {\n      setLoading(true);\n      const data = await Snitch.getAllCoupons(0, filters, sorts);\n      setCoupons([...data]);\n      setPage(0);\n      setHasMore(true);\n    } catch (e) {\n      console.error(e);\n      Snackbar.show('Error Occurred', 'error');\n    }\n  };\n\n  useEffect(() => {\n    refresh();\n  }, [JSON.stringify(filters), JSON.stringify(sorts)]);\n  return [coupons, loadMore, hasMore, loading, refresh];\n}\n\n_s2(useInfiniteCoupons, \"AGmpmrVY5RrIJxS3aP9RnxZbW+A=\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/hooks/coupons.js"],"names":["useEffect","useState","Snitch","Snackbar","Loader","useCoupon","id","coupon","setCoupon","loading","setLoading","refresh","getCoupon","e","console","error","show","useInfiniteCoupons","filters","sorts","coupons","setCoupons","page","setPage","hasMore","setHasMore","loadMore","stopIndex","newPage","Math","floor","data","getAllCoupons","length","hide","JSON","stringify"],"mappings":";;;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,MAAT;AACA,OAAOC,QAAP;AACA,OAAOC,MAAP;AAEA,OAAO,SAASC,SAAT,CAAmBC,EAAnB,EAAuB;AAAA;;AAC5B,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBP,QAAQ,CAAC,IAAD,CAApC;AACA,QAAM,CAACQ,OAAD,EAAUC,UAAV,IAAwBT,QAAQ,CAAC,KAAD,CAAtC;;AAEA,QAAMU,OAAO,GAAG,YAAY;AAC1B,QAAI,CAACL,EAAL,EAAS;AACP;AACD;;AACD,QAAIG,OAAJ,EAAa;AACX;AACD;;AACD,QAAI;AACFC,MAAAA,UAAU,CAAC,IAAD,CAAV;AACAF,MAAAA,SAAS,CAAC,MAAMN,MAAM,CAACU,SAAP,CAAiBN,EAAjB,CAAP,CAAT;AACD,KAHD,CAGE,OAAOO,CAAP,EAAU;AACVC,MAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACAV,MAAAA,QAAQ,CAACa,IAAT,CAAc,gBAAd,EAAgC,OAAhC;AACD,KAND,SAMU;AACRN,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,GAhBD;;AAkBAV,EAAAA,SAAS,CAAC,MAAM;AACdW,IAAAA,OAAO;AACR,GAFQ,EAEN,CAACL,EAAD,CAFM,CAAT;AAIA,SAAO,CAACC,MAAD,EAASI,OAAT,EAAkBF,OAAlB,CAAP;AACD;;GA3BeJ,S;;AA6BhB,OAAO,SAASY,kBAAT,CAA4BC,OAAO,GAAG,EAAtC,EAA0CC,KAAK,GAAG,EAAlD,EAAsD;AAAA;;AAC3D,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBpB,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACQ,OAAD,EAAUC,UAAV,IAAwBT,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACqB,IAAD,EAAOC,OAAP,IAAkBtB,QAAQ,CAAC,CAAD,CAAhC;AACA,QAAM,CAACuB,OAAD,EAAUC,UAAV,IAAwBxB,QAAQ,CAAC,IAAD,CAAtC;;AAEA,QAAMyB,QAAQ,GAAG,OAAO;AAAEC,IAAAA,SAAS,GAAG;AAAd,MAAqB,EAA5B,KAAmC;AAClD,QAAIlB,OAAJ,EAAa;AACX;AACD;;AACD,UAAMmB,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWH,SAAS,GAAG,EAAvB,CAAhB;;AACA,QAAIC,OAAO,IAAIN,IAAf,EAAqB;AACnB;AACD;;AACD,QAAI,CAACE,OAAL,EAAc;AACZ;AACD;;AACD,QAAI;AACFd,MAAAA,UAAU,CAAC,IAAD,CAAV;;AACA,UAAIY,IAAI,KAAK,CAAb,EAAgB;AACdlB,QAAAA,MAAM,CAACY,IAAP;AACD;;AACD,YAAMe,IAAI,GAAG,MAAM7B,MAAM,CAAC8B,aAAP,CAAqBV,IAArB,EAA2BJ,OAA3B,EAAoCC,KAApC,CAAnB;AACAE,MAAAA,UAAU,CAAC,CAAC,GAAGD,OAAJ,EAAa,GAAGW,IAAhB,CAAD,CAAV;;AACA,UAAIA,IAAI,CAACE,MAAL,KAAgB,CAApB,EAAuB;AACrBR,QAAAA,UAAU,CAAC,KAAD,CAAV;AACD;;AACDF,MAAAA,OAAO,CAACD,IAAI,GAAG,CAAR,CAAP;AACD,KAXD,CAWE,OAAOT,CAAP,EAAU;AACVC,MAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACAV,MAAAA,QAAQ,CAACa,IAAT,CAAc,gBAAd,EAAgC,OAAhC;AACD,KAdD,SAcU;AACRZ,MAAAA,MAAM,CAAC8B,IAAP;AACAxB,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,GA7BD;;AA+BA,QAAMC,OAAO,GAAG,YAAY;AAC1B,QAAI;AACFD,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA,YAAMqB,IAAI,GAAG,MAAM7B,MAAM,CAAC8B,aAAP,CAAqB,CAArB,EAAwBd,OAAxB,EAAiCC,KAAjC,CAAnB;AACAE,MAAAA,UAAU,CAAC,CAAC,GAAGU,IAAJ,CAAD,CAAV;AACAR,MAAAA,OAAO,CAAC,CAAD,CAAP;AACAE,MAAAA,UAAU,CAAC,IAAD,CAAV;AACD,KAND,CAME,OAAOZ,CAAP,EAAU;AACVC,MAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACAV,MAAAA,QAAQ,CAACa,IAAT,CAAc,gBAAd,EAAgC,OAAhC;AACD;AACF,GAXD;;AAaAhB,EAAAA,SAAS,CAAC,MAAM;AACdW,IAAAA,OAAO;AACR,GAFQ,EAEN,CAACwB,IAAI,CAACC,SAAL,CAAelB,OAAf,CAAD,EAA0BiB,IAAI,CAACC,SAAL,CAAejB,KAAf,CAA1B,CAFM,CAAT;AAIA,SAAO,CAACC,OAAD,EAAUM,QAAV,EAAoBF,OAApB,EAA6Bf,OAA7B,EAAsCE,OAAtC,CAAP;AACD;;IAvDeM,kB","sourcesContent":["import { useEffect, useState } from 'react';\nimport { Snitch } from 'api';\nimport Snackbar from 'services/snackbar';\nimport Loader from 'services/loader';\n\nexport function useCoupon(id) {\n  const [coupon, setCoupon] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  const refresh = async () => {\n    if (!id) {\n      return;\n    }\n    if (loading) {\n      return;\n    }\n    try {\n      setLoading(true);\n      setCoupon(await Snitch.getCoupon(id));\n    } catch (e) {\n      console.error(e);\n      Snackbar.show('error occurred', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    refresh();\n  }, [id]);\n\n  return [coupon, refresh, loading];\n}\n\nexport function useInfiniteCoupons(filters = {}, sorts = {}) {\n  const [coupons, setCoupons] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [page, setPage] = useState(0);\n  const [hasMore, setHasMore] = useState(true);\n\n  const loadMore = async ({ stopIndex = 10 } = {}) => {\n    if (loading) {\n      return;\n    }\n    const newPage = Math.floor(stopIndex / 10);\n    if (newPage <= page) {\n      return;\n    }\n    if (!hasMore) {\n      return;\n    }\n    try {\n      setLoading(true);\n      if (page === 0) {\n        Loader.show();\n      }\n      const data = await Snitch.getAllCoupons(page, filters, sorts);\n      setCoupons([...coupons, ...data]);\n      if (data.length === 0) {\n        setHasMore(false);\n      }\n      setPage(page + 1);\n    } catch (e) {\n      console.error(e);\n      Snackbar.show('Error Occurred', 'error');\n    } finally {\n      Loader.hide();\n      setLoading(false);\n    }\n  };\n\n  const refresh = async () => {\n    try {\n      setLoading(true);\n      const data = await Snitch.getAllCoupons(0, filters, sorts);\n      setCoupons([...data]);\n      setPage(0);\n      setHasMore(true);\n    } catch (e) {\n      console.error(e);\n      Snackbar.show('Error Occurred', 'error');\n    }\n  };\n\n  useEffect(() => {\n    refresh();\n  }, [JSON.stringify(filters), JSON.stringify(sorts)]);\n\n  return [coupons, loadMore, hasMore, loading, refresh];\n}\n"]},"metadata":{},"sourceType":"module"}