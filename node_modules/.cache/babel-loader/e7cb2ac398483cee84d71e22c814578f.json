{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/components/userProfile/LivePostsGrid.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Grid, InfiniteLoader } from 'react-virtualized';\nimport { useLivePosts } from \"../../hooks/posts\";\nimport carouselIcon from \"../../assets/images/profile/carouselIcon.svg\";\nimport videoIcon from \"../../assets/images/profile/videoIcon.svg\";\nimport cx from 'classnames';\nimport { SnackBar } from \"../../services\";\nimport Loader from \"../../services/loader\";\nimport { useHistory } from 'react-router-dom';\nimport { useQueryParams } from \"../../hooks\";\nimport Player from \"../shared/Player/Carousel\";\nimport { useToggle } from \"../../hooks/common\";\nimport { DeleteAlert } from \"../shared/DeleteAlert\";\nimport { Button } from 'phoenix-components';\nimport { Nikon } from \"../../api\";\nimport { useDesktop } from \"../../contexts\";\nimport { useOpenCreateAsProduct } from \"../../hooks/userProfile\";\nimport checkIcon from \"../../assets/images/profile/check.svg\";\nimport { Clickable } from 'phoenix-components';\nimport { FooterButton } from \"../common/FooterButton\";\nimport { FabMenu } from \"../shared/FabMenu\";\nimport styles from \"./LivePostsGrid.module.css\";\nexport function LivePostsGrid({\n  top,\n  refresh\n}) {\n  _s();\n\n  var _top$current, _top$current$getBound;\n\n  const [posts, loadMore, hasMore,, refreshPosts] = useLivePosts({}, {\n    createdOn: -1\n  });\n  const [checked, setChecked] = useState([]);\n  const [openDelete, toggleDelete] = useToggle(false);\n  const history = useHistory();\n  const params = useQueryParams();\n  const openProduct = useOpenCreateAsProduct();\n  const rowCount = hasMore ? 10000 : posts.length;\n\n  const isLoaded = i => !!posts[i];\n\n  const checkedSet = new Set(checked);\n  const isDesktop = useDesktop();\n  const topBar = (top === null || top === void 0 ? void 0 : (_top$current = top.current) === null || _top$current === void 0 ? void 0 : (_top$current$getBound = _top$current.getBoundingClientRect()) === null || _top$current$getBound === void 0 ? void 0 : _top$current$getBound.top) || 120;\n  const height = isDesktop ? window.screen.height - topBar - 78 - 60 - (checkedSet.size > 0 ? 48 : 0) : window.screen.height - topBar - 20 - (checkedSet.size > 0 ? 48 : 0);\n  const cellWidth = isDesktop ? (window.screen.width - 320 - 60 - 300) / 4 : (window.screen.width - 16) / 3;\n\n  const onSectionRendered = onRowsRendered => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 3 + columnStartIndex;\n    const stopIndex = rowStopIndex * 3 + columnStopIndex;\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  }; // eslint-disable-next-line react/no-multi-comp\n\n\n  const renderIcon = post => {\n    switch (post.postType) {\n      case 'image carousel':\n        return /*#__PURE__*/React.createElement(\"img\", {\n          src: carouselIcon,\n          alt: \"\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 16\n          }\n        });\n\n      case 'video':\n        return /*#__PURE__*/React.createElement(\"img\", {\n          src: videoIcon,\n          alt: \"\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 16\n          }\n        });\n\n      default:\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 16\n          }\n        }, \"\\xA0\");\n    }\n  };\n\n  const deletePosts = async () => {\n    if (checkedSet.size === 0) {\n      return;\n    }\n\n    try {\n      Loader.show();\n      await Nikon.deletePosts([...checkedSet]);\n      await refreshPosts();\n      refresh();\n      toggleDelete();\n      setChecked([]);\n    } catch (e) {\n      SnackBar.show('something went wrong, try again', 'error');\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const openPost = id => () => {\n    params.set('post', id);\n    history.push({\n      search: params.toString()\n    });\n  };\n\n  const onCheck = id => e => {\n    e.stopPropagation();\n\n    if (checkedSet.has(id)) {\n      checkedSet.delete(id);\n      setChecked([...checkedSet]);\n      return;\n    }\n\n    setChecked([...checkedSet, id]);\n  }; // eslint-disable-next-line react/no-multi-comp\n\n\n  const renderCell = el => {\n    const idx = el.rowIndex * (isDesktop ? 4 : 3) + el.columnIndex;\n\n    if (idx >= posts.length) {\n      return null;\n    }\n\n    const post = posts[idx];\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: el.key,\n      style: el.style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.post,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.container // style={{\n      //   backgroundSize: 'cover',\n      //   backgroundImage: `url(${post.preview})`,\n      // }}\n      ,\n      onClick: openPost(post.pid),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.inner,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 13\n      }\n    }, post.postType !== 'video' && /*#__PURE__*/React.createElement(\"img\", {\n      className: styles.img,\n      src: post.preview,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }\n    }), post.postType === 'video' && /*#__PURE__*/React.createElement(Player, {\n      isPreview: false,\n      item: {\n        url: post.video\n      },\n      className: styles.img,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.iconContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 15\n      }\n    }, renderIcon(post)), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.checkBoxContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      onClick: onCheck(post.pid),\n      className: cx(styles.radio, {\n        [styles.selected]: checkedSet.has(post.pid)\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }\n    }, checkedSet.has(post.pid) && /*#__PURE__*/React.createElement(\"img\", {\n      src: checkIcon,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 48\n      }\n    }))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.buttonContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Clickable, {\n      className: styles.button,\n      onClick: () => openProduct(post.pid),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }\n    }, \"Add as Product\"))));\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, openDelete && /*#__PURE__*/React.createElement(DeleteAlert, {\n    title: \"Are you sure want to delete selected Posts?\",\n    onCancel: toggleDelete,\n    onDelete: deletePosts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 9\n    }\n  }), posts.length > 0 && /*#__PURE__*/React.createElement(InfiniteLoader, {\n    loadMoreRows: loadMore,\n    isRowLoaded: isLoaded,\n    rowCount: rowCount,\n    minimumBatchSize: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  }, ({\n    onRowsRendered,\n    registerChild\n  }) => /*#__PURE__*/React.createElement(Grid, {\n    onSectionRendered: onSectionRendered(onRowsRendered),\n    ref: registerChild,\n    cellRenderer: renderCell,\n    columnCount: isDesktop ? 4 : 3,\n    columnWidth: isDesktop ? cellWidth : cellWidth,\n    height: height,\n    rowCount: Math.ceil(rowCount / (isDesktop ? 1 : 3)),\n    rowHeight: 184,\n    style: {\n      display: 'flex'\n    },\n    width: isDesktop ? window.screen.width - 650 : window.screen.width,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(FabMenu, {\n    refresh: refreshPosts,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 7\n    }\n  }), checkedSet.size > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.unliveContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 9\n    }\n  }, checkedSet.size > 0 && /*#__PURE__*/React.createElement(FooterButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.btns,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    label: \"Delete\",\n    size: \"large\",\n    primary: false,\n    onClick: toggleDelete,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    label: \"Add as Product\",\n    size: \"large\",\n    onClick: async () => {\n      const videos = [];\n      const images = [];\n      checkedSet.forEach(x => {\n        const post = posts.find(y => y.pid === x);\n        const {\n          desc,\n          postType,\n          preview,\n          video,\n          images: postImages,\n          pid\n        } = post;\n\n        if (postType === 'video') {\n          videos.push({\n            caption: desc,\n            postType,\n            url: video,\n            pid\n          });\n        }\n\n        if (postType === 'image carousel') {\n          // eslint-disable-next-line array-callback-return\n          postImages.map(y => {\n            images.push({\n              caption: y.caption,\n              postType: 'image',\n              url: y.url,\n              pid\n            });\n          });\n        }\n\n        if (postType === 'image') {\n          images.push({\n            caption: desc,\n            postType,\n            url: preview,\n            pid\n          });\n        }\n      });\n\n      if ([...videos, ...images].length > 8) {\n        SnackBar.show('You can add maximum upload 8 files', 'error');\n        return;\n      }\n\n      if ([...videos, ...images].length === 1) {\n        const {\n          pid\n        } = [...videos, ...images][0];\n        openProduct(pid);\n        return;\n      }\n\n      history.push({\n        pathname: '/products/create',\n        state: {\n          images,\n          videos\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 17\n    }\n  })))));\n}\n\n_s(LivePostsGrid, \"Vz1hrv8E23Vv2g8hegaNG8LflZc=\", false, function () {\n  return [useLivePosts, useToggle, useHistory, useQueryParams, useOpenCreateAsProduct, useDesktop];\n});\n\n_c = LivePostsGrid;\nLivePostsGrid.propTypes = {\n  top: PropTypes.any.isRequired,\n  refresh: PropTypes.func.isRequired\n};\nLivePostsGrid.defaultProps = {};\n\nvar _c;\n\n$RefreshReg$(_c, \"LivePostsGrid\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/components/userProfile/LivePostsGrid.jsx"],"names":["React","useState","PropTypes","Grid","InfiniteLoader","useLivePosts","cx","SnackBar","Loader","useHistory","useQueryParams","Player","useToggle","DeleteAlert","Button","Nikon","useDesktop","useOpenCreateAsProduct","Clickable","FooterButton","FabMenu","styles","LivePostsGrid","top","refresh","posts","loadMore","hasMore","refreshPosts","createdOn","checked","setChecked","openDelete","toggleDelete","history","params","openProduct","rowCount","length","isLoaded","i","checkedSet","Set","isDesktop","topBar","current","getBoundingClientRect","height","window","screen","size","cellWidth","width","onSectionRendered","onRowsRendered","columnStartIndex","columnStopIndex","rowStartIndex","rowStopIndex","startIndex","stopIndex","renderIcon","post","postType","carouselIcon","videoIcon","deletePosts","show","e","hide","openPost","id","set","push","search","toString","onCheck","stopPropagation","has","delete","renderCell","el","idx","rowIndex","columnIndex","key","style","container","pid","inner","img","preview","url","video","iconContainer","checkBoxContainer","radio","selected","checkIcon","buttonContainer","button","registerChild","Math","ceil","display","unliveContainer","btns","videos","images","forEach","x","find","y","desc","postImages","caption","map","pathname","state","propTypes","any","isRequired","func","defaultProps"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,IAAT,EAAeC,cAAf,QAAqC,mBAArC;AACA,SAASC,YAAT;;;AAGA,OAAOC,EAAP,MAAe,YAAf;AACA,SAASC,QAAT;AACA,OAAOC,MAAP;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,cAAT;AACA,OAAOC,MAAP;AACA,SAASC,SAAT;AACA,SAASC,WAAT;AACA,SAASC,MAAT,QAAuB,oBAAvB;AACA,SAASC,KAAT;AACA,SAASC,UAAT;AACA,SAASC,sBAAT;;AAEA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,YAAT;AACA,SAASC,OAAT;AACA,OAAOC,MAAP;AAEA,OAAO,SAASC,aAAT,CAAuB;AAC5BC,EAAAA,GAD4B;AAE5BC,EAAAA;AAF4B,CAAvB,EAGJ;AAAA;;AAAA;;AACD,QAAM,CAACC,KAAD,EAAQC,QAAR,EAAkBC,OAAlB,GAA6BC,YAA7B,IAA6CvB,YAAY,CAAC,EAAD,EAAK;AAAEwB,IAAAA,SAAS,EAAE,CAAC;AAAd,GAAL,CAA/D;AACA,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwB9B,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAAC+B,UAAD,EAAaC,YAAb,IAA6BrB,SAAS,CAAC,KAAD,CAA5C;AACA,QAAMsB,OAAO,GAAGzB,UAAU,EAA1B;AACA,QAAM0B,MAAM,GAAGzB,cAAc,EAA7B;AACA,QAAM0B,WAAW,GAAGnB,sBAAsB,EAA1C;AACA,QAAMoB,QAAQ,GAAGV,OAAO,GAAG,KAAH,GAAWF,KAAK,CAACa,MAAzC;;AACA,QAAMC,QAAQ,GAAGC,CAAC,IAAI,CAAC,CAACf,KAAK,CAACe,CAAD,CAA7B;;AACA,QAAMC,UAAU,GAAG,IAAIC,GAAJ,CAAQZ,OAAR,CAAnB;AACA,QAAMa,SAAS,GAAG3B,UAAU,EAA5B;AAEA,QAAM4B,MAAM,GAAG,CAAArB,GAAG,SAAH,IAAAA,GAAG,WAAH,4BAAAA,GAAG,CAAEsB,OAAL,uFAAcC,qBAAd,kFAAuCvB,GAAvC,KAA8C,GAA7D;AACA,QAAMwB,MAAM,GAAGJ,SAAS,GACpBK,MAAM,CAACC,MAAP,CAAcF,MAAd,GAAuBH,MAAvB,GAAgC,EAAhC,GAAqC,EAArC,IAA2CH,UAAU,CAACS,IAAX,GAAkB,CAAlB,GAAsB,EAAtB,GAA2B,CAAtE,CADoB,GAEpBF,MAAM,CAACC,MAAP,CAAcF,MAAd,GAAuBH,MAAvB,GAAgC,EAAhC,IAAsCH,UAAU,CAACS,IAAX,GAAkB,CAAlB,GAAsB,EAAtB,GAA2B,CAAjE,CAFJ;AAGA,QAAMC,SAAS,GAAGR,SAAS,GAAG,CAACK,MAAM,CAACC,MAAP,CAAcG,KAAd,GAAsB,GAAtB,GAA4B,EAA5B,GAAiC,GAAlC,IAAyC,CAA5C,GAAgD,CAACJ,MAAM,CAACC,MAAP,CAAcG,KAAd,GAAsB,EAAvB,IAA6B,CAAxG;;AAEA,QAAMC,iBAAiB,GAAIC,cAAD,IAAoB,CAAC;AAC7CC,IAAAA,gBAD6C;AAE7CC,IAAAA,eAF6C;AAG7CC,IAAAA,aAH6C;AAI7CC,IAAAA;AAJ6C,GAAD,KAKxC;AACJ,UAAMC,UAAU,GAAGF,aAAa,GAAG,CAAhB,GAAoBF,gBAAvC;AACA,UAAMK,SAAS,GAAGF,YAAY,GAAG,CAAf,GAAmBF,eAArC;AAEAF,IAAAA,cAAc,CAAC;AACbK,MAAAA,UADa;AAEbC,MAAAA;AAFa,KAAD,CAAd;AAID,GAbD,CAlBC,CAiCD;;;AACA,QAAMC,UAAU,GAAIC,IAAD,IAAU;AAC3B,YAAQA,IAAI,CAACC,QAAb;AACE,WAAK,gBAAL;AACE,4BAAO;AAAK,UAAA,GAAG,EAAEC,YAAV;AAAwB,UAAA,GAAG,EAAC,EAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;;AACF,WAAK,OAAL;AACE,4BAAO;AAAK,UAAA,GAAG,EAAEC,SAAV;AAAqB,UAAA,GAAG,EAAC,EAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;;AACF;AACE,4BAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAP;AANJ;AAQD,GATD;;AAWA,QAAMC,WAAW,GAAG,YAAY;AAC9B,QAAIzB,UAAU,CAACS,IAAX,KAAoB,CAAxB,EAA2B;AACzB;AACD;;AACD,QAAI;AACF1C,MAAAA,MAAM,CAAC2D,IAAP;AACA,YAAMpD,KAAK,CAACmD,WAAN,CAAkB,CAAC,GAAGzB,UAAJ,CAAlB,CAAN;AACA,YAAMb,YAAY,EAAlB;AACAJ,MAAAA,OAAO;AACPS,MAAAA,YAAY;AACZF,MAAAA,UAAU,CAAC,EAAD,CAAV;AACD,KAPD,CAOE,OAAOqC,CAAP,EAAU;AACV7D,MAAAA,QAAQ,CAAC4D,IAAT,CAAc,iCAAd,EAAiD,OAAjD;AACD,KATD,SASU;AACR3D,MAAAA,MAAM,CAAC6D,IAAP;AACD;AACF,GAhBD;;AAkBA,QAAMC,QAAQ,GAAIC,EAAD,IAAQ,MAAM;AAC7BpC,IAAAA,MAAM,CAACqC,GAAP,CAAW,MAAX,EAAmBD,EAAnB;AACArC,IAAAA,OAAO,CAACuC,IAAR,CAAa;AACXC,MAAAA,MAAM,EAAEvC,MAAM,CAACwC,QAAP;AADG,KAAb;AAGD,GALD;;AAOA,QAAMC,OAAO,GAAIL,EAAD,IAASH,CAAD,IAAO;AAC7BA,IAAAA,CAAC,CAACS,eAAF;;AACA,QAAIpC,UAAU,CAACqC,GAAX,CAAeP,EAAf,CAAJ,EAAwB;AACtB9B,MAAAA,UAAU,CAACsC,MAAX,CAAkBR,EAAlB;AACAxC,MAAAA,UAAU,CAAC,CAAC,GAAGU,UAAJ,CAAD,CAAV;AACA;AACD;;AACDV,IAAAA,UAAU,CAAC,CAAC,GAAGU,UAAJ,EAAgB8B,EAAhB,CAAD,CAAV;AACD,GARD,CAtEC,CAgFD;;;AACA,QAAMS,UAAU,GAAIC,EAAD,IAAQ;AACzB,UAAMC,GAAG,GAAGD,EAAE,CAACE,QAAH,IAAexC,SAAS,GAAG,CAAH,GAAO,CAA/B,IAAoCsC,EAAE,CAACG,WAAnD;;AACA,QAAIF,GAAG,IAAIzD,KAAK,CAACa,MAAjB,EAAyB;AACvB,aAAO,IAAP;AACD;;AACD,UAAMwB,IAAI,GAAGrC,KAAK,CAACyD,GAAD,CAAlB;AACA,wBACE;AAAK,MAAA,GAAG,EAAED,EAAE,CAACI,GAAb;AAAkB,MAAA,KAAK,EAAEJ,EAAE,CAACK,KAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAEjE,MAAM,CAACyC,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,SAAS,EAAEzC,MAAM,CAACkE,SADpB,CAEE;AACA;AACA;AACA;AALF;AAME,MAAA,OAAO,EAAEjB,QAAQ,CAACR,IAAI,CAAC0B,GAAN,CANnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAQE;AAAK,MAAA,SAAS,EAAEnE,MAAM,CAACoE,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG3B,IAAI,CAACC,QAAL,KAAkB,OAAlB,iBACC;AAAK,MAAA,SAAS,EAAE1C,MAAM,CAACqE,GAAvB;AAA4B,MAAA,GAAG,EAAE5B,IAAI,CAAC6B,OAAtC;AAA+C,MAAA,GAAG,EAAC,EAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,EAIG7B,IAAI,CAACC,QAAL,KAAkB,OAAlB,iBACC,oBAAC,MAAD;AAAQ,MAAA,SAAS,EAAE,KAAnB;AAA0B,MAAA,IAAI,EAAE;AAAE6B,QAAAA,GAAG,EAAE9B,IAAI,CAAC+B;AAAZ,OAAhC;AAAqD,MAAA,SAAS,EAAExE,MAAM,CAACqE,GAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALJ,eAOE;AAAK,MAAA,SAAS,EAAErE,MAAM,CAACyE,aAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGjC,UAAU,CAACC,IAAD,CADb,CAPF,eAUE;AAAK,MAAA,SAAS,EAAEzC,MAAM,CAAC0E,iBAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,OAAO,EAAEnB,OAAO,CAACd,IAAI,CAAC0B,GAAN,CADlB;AAEE,MAAA,SAAS,EAAElF,EAAE,CAACe,MAAM,CAAC2E,KAAR,EAAe;AAC1B,SAAC3E,MAAM,CAAC4E,QAAR,GAAmBxD,UAAU,CAACqC,GAAX,CAAehB,IAAI,CAAC0B,GAApB;AADO,OAAf,CAFf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAMG/C,UAAU,CAACqC,GAAX,CAAehB,IAAI,CAAC0B,GAApB,kBAA4B;AAAK,MAAA,GAAG,EAAEU,SAAV;AAAqB,MAAA,GAAG,EAAC,EAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAN/B,CADF,CAVF,CARF,CADF,eA+BE;AAAK,MAAA,SAAS,EAAE7E,MAAM,CAAC8E,eAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,SAAD;AACE,MAAA,SAAS,EAAE9E,MAAM,CAAC+E,MADpB;AAEE,MAAA,OAAO,EAAE,MAAMhE,WAAW,CAAC0B,IAAI,CAAC0B,GAAN,CAF5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,CA/BF,CADF,CADF;AA4CD,GAlDD;;AAoDA,sBACE,0CACGxD,UAAU,iBAET,oBAAC,WAAD;AACE,IAAA,KAAK,EAAC,6CADR;AAEE,IAAA,QAAQ,EAAEC,YAFZ;AAGE,IAAA,QAAQ,EAAEiC,WAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHJ,EASGzC,KAAK,CAACa,MAAN,GAAe,CAAf,iBACC,oBAAC,cAAD;AACE,IAAA,YAAY,EAAEZ,QADhB;AAEE,IAAA,WAAW,EAAEa,QAFf;AAGE,IAAA,QAAQ,EAAEF,QAHZ;AAIE,IAAA,gBAAgB,EAAE,EAJpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMG,CAAC;AACAiB,IAAAA,cADA;AAEA+C,IAAAA;AAFA,GAAD,kBAIC,oBAAC,IAAD;AACE,IAAA,iBAAiB,EAAEhD,iBAAiB,CAACC,cAAD,CADtC;AAEE,IAAA,GAAG,EAAE+C,aAFP;AAGE,IAAA,YAAY,EAAErB,UAHhB;AAIE,IAAA,WAAW,EAAErC,SAAS,GAAG,CAAH,GAAO,CAJ/B;AAKE,IAAA,WAAW,EAAEA,SAAS,GAAGQ,SAAH,GAAeA,SALvC;AAME,IAAA,MAAM,EAAEJ,MANV;AAOE,IAAA,QAAQ,EAAEuD,IAAI,CAACC,IAAL,CAAUlE,QAAQ,IAAIM,SAAS,GAAG,CAAH,GAAO,CAApB,CAAlB,CAPZ;AAQE,IAAA,SAAS,EAAE,GARb;AASE,IAAA,KAAK,EAAE;AAAE6D,MAAAA,OAAO,EAAE;AAAX,KATT;AAUE,IAAA,KAAK,EAAE7D,SAAS,GAAGK,MAAM,CAACC,MAAP,CAAcG,KAAd,GAAsB,GAAzB,GAA+BJ,MAAM,CAACC,MAAP,CAAcG,KAV/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVJ,CAVJ,eAmCE,oBAAC,OAAD;AAAS,IAAA,OAAO,EAAExB,YAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAnCF,EAoCGa,UAAU,CAACS,IAAX,GAAkB,CAAlB,iBACC;AAAK,IAAA,SAAS,EAAE7B,MAAM,CAACoF,eAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGhE,UAAU,CAACS,IAAX,GAAkB,CAAlB,iBACC,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAE7B,MAAM,CAACqF,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,KAAK,EAAC,QADR;AAEE,IAAA,IAAI,EAAC,OAFP;AAGE,IAAA,OAAO,EAAE,KAHX;AAIE,IAAA,OAAO,EAAEzE,YAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAOE,oBAAC,MAAD;AACE,IAAA,KAAK,EAAC,gBADR;AAEE,IAAA,IAAI,EAAC,OAFP;AAGE,IAAA,OAAO,EAAE,YAAY;AACnB,YAAM0E,MAAM,GAAG,EAAf;AACA,YAAMC,MAAM,GAAG,EAAf;AACAnE,MAAAA,UAAU,CAACoE,OAAX,CAAoBC,CAAD,IAAO;AACxB,cAAMhD,IAAI,GAAGrC,KAAK,CAACsF,IAAN,CAAWC,CAAC,IAAIA,CAAC,CAACxB,GAAF,KAAUsB,CAA1B,CAAb;AACA,cAAM;AACJG,UAAAA,IADI;AACElD,UAAAA,QADF;AACY4B,UAAAA,OADZ;AACqBE,UAAAA,KADrB;AAC4Be,UAAAA,MAAM,EAAEM,UADpC;AACgD1B,UAAAA;AADhD,YAEF1B,IAFJ;;AAGA,YAAIC,QAAQ,KAAK,OAAjB,EAA0B;AACxB4C,UAAAA,MAAM,CAAClC,IAAP,CAAY;AACV0C,YAAAA,OAAO,EAAEF,IADC;AACKlD,YAAAA,QADL;AACe6B,YAAAA,GAAG,EAAEC,KADpB;AAC2BL,YAAAA;AAD3B,WAAZ;AAGD;;AACD,YAAIzB,QAAQ,KAAK,gBAAjB,EAAmC;AACjC;AACAmD,UAAAA,UAAU,CAACE,GAAX,CAAeJ,CAAC,IAAI;AAClBJ,YAAAA,MAAM,CAACnC,IAAP,CAAY;AACV0C,cAAAA,OAAO,EAAEH,CAAC,CAACG,OADD;AACUpD,cAAAA,QAAQ,EAAE,OADpB;AAC6B6B,cAAAA,GAAG,EAAEoB,CAAC,CAACpB,GADpC;AACyCJ,cAAAA;AADzC,aAAZ;AAGD,WAJD;AAKD;;AACD,YAAIzB,QAAQ,KAAK,OAAjB,EAA0B;AACxB6C,UAAAA,MAAM,CAACnC,IAAP,CAAY;AACV0C,YAAAA,OAAO,EAAEF,IADC;AACKlD,YAAAA,QADL;AACe6B,YAAAA,GAAG,EAAED,OADpB;AAC6BH,YAAAA;AAD7B,WAAZ;AAGD;AACF,OAvBD;;AAwBA,UAAI,CAAC,GAAGmB,MAAJ,EAAY,GAAGC,MAAf,EAAuBtE,MAAvB,GAAgC,CAApC,EAAuC;AACrC/B,QAAAA,QAAQ,CAAC4D,IAAT,CAAc,oCAAd,EAAoD,OAApD;AACA;AACD;;AACD,UAAI,CAAC,GAAGwC,MAAJ,EAAY,GAAGC,MAAf,EAAuBtE,MAAvB,KAAkC,CAAtC,EAAyC;AACvC,cAAM;AAAEkD,UAAAA;AAAF,YAAU,CAAC,GAAGmB,MAAJ,EAAY,GAAGC,MAAf,EAAuB,CAAvB,CAAhB;AACAxE,QAAAA,WAAW,CAACoD,GAAD,CAAX;AACA;AACD;;AACDtD,MAAAA,OAAO,CAACuC,IAAR,CAAa;AAAE4C,QAAAA,QAAQ,EAAE,kBAAZ;AAAgCC,QAAAA,KAAK,EAAE;AAAEV,UAAAA,MAAF;AAAUD,UAAAA;AAAV;AAAvC,OAAb;AACD,KAxCH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,CADF,CAFJ,CArCJ,CADF;AAiGD;;GAzOerF,a;UAIqCjB,Y,EAEhBO,S,EACnBH,U,EACDC,c,EACKO,sB,EAIFD,U;;;KAbJM,a;AA2OhBA,aAAa,CAACiG,SAAd,GAA0B;AACxBhG,EAAAA,GAAG,EAAErB,SAAS,CAACsH,GAAV,CAAcC,UADK;AAExBjG,EAAAA,OAAO,EAAEtB,SAAS,CAACwH,IAAV,CAAeD;AAFA,CAA1B;AAIAnG,aAAa,CAACqG,YAAd,GAA6B,EAA7B","sourcesContent":["import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Grid, InfiniteLoader } from 'react-virtualized';\nimport { useLivePosts } from 'hooks/posts';\nimport carouselIcon from 'assets/images/profile/carouselIcon.svg';\nimport videoIcon from 'assets/images/profile/videoIcon.svg';\nimport cx from 'classnames';\nimport { SnackBar } from 'services';\nimport Loader from 'services/loader';\nimport { useHistory } from 'react-router-dom';\nimport { useQueryParams } from 'hooks';\nimport Player from 'components/shared/Player/Carousel';\nimport { useToggle } from 'hooks/common';\nimport { DeleteAlert } from 'components/shared/DeleteAlert';\nimport { Button } from 'phoenix-components';\nimport { Nikon } from 'api';\nimport { useDesktop } from 'contexts';\nimport { useOpenCreateAsProduct } from 'hooks/userProfile';\nimport checkIcon from 'assets/images/profile/check.svg';\nimport { Clickable } from 'phoenix-components';\nimport { FooterButton } from 'components/common/FooterButton';\nimport { FabMenu } from 'components/shared/FabMenu';\nimport styles from './LivePostsGrid.module.css';\n\nexport function LivePostsGrid({\n  top,\n  refresh\n}) {\n  const [posts, loadMore, hasMore, , refreshPosts] = useLivePosts({}, { createdOn: -1 });\n  const [checked, setChecked] = useState([]);\n  const [openDelete, toggleDelete] = useToggle(false);\n  const history = useHistory();\n  const params = useQueryParams();\n  const openProduct = useOpenCreateAsProduct();\n  const rowCount = hasMore ? 10000 : posts.length;\n  const isLoaded = i => !!posts[i];\n  const checkedSet = new Set(checked);\n  const isDesktop = useDesktop();\n\n  const topBar = top?.current?.getBoundingClientRect()?.top || 120;\n  const height = isDesktop\n    ? window.screen.height - topBar - 78 - 60 - (checkedSet.size > 0 ? 48 : 0)\n    : window.screen.height - topBar - 20 - (checkedSet.size > 0 ? 48 : 0);\n  const cellWidth = isDesktop ? (window.screen.width - 320 - 60 - 300) / 4 : (window.screen.width - 16) / 3;\n\n  const onSectionRendered = (onRowsRendered) => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 3 + columnStartIndex;\n    const stopIndex = rowStopIndex * 3 + columnStopIndex;\n\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  // eslint-disable-next-line react/no-multi-comp\n  const renderIcon = (post) => {\n    switch (post.postType) {\n      case 'image carousel':\n        return <img src={carouselIcon} alt=\"\" />;\n      case 'video':\n        return <img src={videoIcon} alt=\"\" />;\n      default:\n        return <div>&nbsp;</div>;\n    }\n  };\n\n  const deletePosts = async () => {\n    if (checkedSet.size === 0) {\n      return;\n    }\n    try {\n      Loader.show();\n      await Nikon.deletePosts([...checkedSet]);\n      await refreshPosts();\n      refresh();\n      toggleDelete();\n      setChecked([]);\n    } catch (e) {\n      SnackBar.show('something went wrong, try again', 'error');\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const openPost = (id) => () => {\n    params.set('post', id);\n    history.push({\n      search: params.toString(),\n    });\n  };\n\n  const onCheck = (id) => (e) => {\n    e.stopPropagation();\n    if (checkedSet.has(id)) {\n      checkedSet.delete(id);\n      setChecked([...checkedSet]);\n      return;\n    }\n    setChecked([...checkedSet, id]);\n  };\n\n  // eslint-disable-next-line react/no-multi-comp\n  const renderCell = (el) => {\n    const idx = el.rowIndex * (isDesktop ? 4 : 3) + el.columnIndex;\n    if (idx >= posts.length) {\n      return null;\n    }\n    const post = posts[idx];\n    return (\n      <div key={el.key} style={el.style}>\n        <div className={styles.post}>\n          <div\n            className={styles.container}\n            // style={{\n            //   backgroundSize: 'cover',\n            //   backgroundImage: `url(${post.preview})`,\n            // }}\n            onClick={openPost(post.pid)}\n          >\n            <div className={styles.inner}>\n              {post.postType !== 'video' && (\n                <img className={styles.img} src={post.preview} alt=\"\" />\n              )}\n              {post.postType === 'video' && (\n                <Player isPreview={false} item={{ url: post.video }} className={styles.img} />\n              )}\n              <div className={styles.iconContainer}>\n                {renderIcon(post)}\n              </div>\n              <div className={styles.checkBoxContainer}>\n                <div\n                  onClick={onCheck(post.pid)}\n                  className={cx(styles.radio, {\n                    [styles.selected]: checkedSet.has(post.pid)\n                  })}\n                >\n                  {checkedSet.has(post.pid) && <img src={checkIcon} alt=\"\" />}\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className={styles.buttonContainer}>\n            <Clickable\n              className={styles.button}\n              onClick={() => openProduct(post.pid)}\n            >\n              Add as Product\n            </Clickable>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      {openDelete\n      && (\n        <DeleteAlert\n          title=\"Are you sure want to delete selected Posts?\"\n          onCancel={toggleDelete}\n          onDelete={deletePosts}\n        />\n      )}\n      {posts.length > 0 && (\n        <InfiniteLoader\n          loadMoreRows={loadMore}\n          isRowLoaded={isLoaded}\n          rowCount={rowCount}\n          minimumBatchSize={10}\n        >\n          {({\n            onRowsRendered,\n            registerChild\n          }) => (\n            <Grid\n              onSectionRendered={onSectionRendered(onRowsRendered)}\n              ref={registerChild}\n              cellRenderer={renderCell}\n              columnCount={isDesktop ? 4 : 3}\n              columnWidth={isDesktop ? cellWidth : cellWidth}\n              height={height}\n              rowCount={Math.ceil(rowCount / (isDesktop ? 1 : 3))}\n              rowHeight={184}\n              style={{ display: 'flex' }}\n              width={isDesktop ? window.screen.width - 650 : window.screen.width}\n            />\n          )}\n        </InfiniteLoader>\n      )}\n      <FabMenu refresh={refreshPosts} />\n      {checkedSet.size > 0 && (\n        <div className={styles.unliveContainer}>\n          {checkedSet.size > 0 && (\n            <FooterButton>\n              <div className={styles.btns}>\n                <Button\n                  label=\"Delete\"\n                  size=\"large\"\n                  primary={false}\n                  onClick={toggleDelete}\n                />\n                <Button\n                  label=\"Add as Product\"\n                  size=\"large\"\n                  onClick={async () => {\n                    const videos = [];\n                    const images = [];\n                    checkedSet.forEach((x) => {\n                      const post = posts.find(y => y.pid === x);\n                      const {\n                        desc, postType, preview, video, images: postImages, pid\n                      } = post;\n                      if (postType === 'video') {\n                        videos.push({\n                          caption: desc, postType, url: video, pid\n                        });\n                      }\n                      if (postType === 'image carousel') {\n                        // eslint-disable-next-line array-callback-return\n                        postImages.map(y => {\n                          images.push({\n                            caption: y.caption, postType: 'image', url: y.url, pid\n                          });\n                        });\n                      }\n                      if (postType === 'image') {\n                        images.push({\n                          caption: desc, postType, url: preview, pid\n                        });\n                      }\n                    });\n                    if ([...videos, ...images].length > 8) {\n                      SnackBar.show('You can add maximum upload 8 files', 'error');\n                      return;\n                    }\n                    if ([...videos, ...images].length === 1) {\n                      const { pid } = [...videos, ...images][0];\n                      openProduct(pid);\n                      return;\n                    }\n                    history.push({ pathname: '/products/create', state: { images, videos } });\n                  }}\n                />\n              </div>\n            </FooterButton>\n          )}\n        </div>\n      )}\n    </>\n  );\n}\n\nLivePostsGrid.propTypes = {\n  top: PropTypes.any.isRequired,\n  refresh: PropTypes.func.isRequired,\n};\nLivePostsGrid.defaultProps = {};\n"]},"metadata":{},"sourceType":"module"}