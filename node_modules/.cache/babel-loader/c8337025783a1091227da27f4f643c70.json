{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/containers/orders/List.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { InfiniteLoader, List } from 'react-virtualized';\nimport { useInfiniteOrders, useQueryParams } from \"../../hooks\";\nimport { OrderCard } from \"../../components/orders\";\nimport { Loading } from \"../../components/shared/Loading\";\nimport { Picker } from \"../../components/shared/dateRangePicker/Picker\";\nimport emptyOrder from \"../../assets/overview/newOrder.svg\"; // import chevronLeftDesk from 'assets/images/products/create/back.svg';\n\nimport { Search } from 'phoenix-components';\nimport { useIsCartAbandonmentEnabled, useIsUserRated, useIsRatingsEnabled, useIsFreePlan } from \"../../contexts\";\nimport cx from 'classnames';\nimport _ from 'lodash';\nimport Faq from \"../../components/faq/Custom\";\nimport { customDateFilters, getText } from \"../utils\";\nimport { StatusSelectionBar } from \"../../components/shared/StatusSelectionBar\";\nimport { canTakeRating, setRatingShown } from \"../../utils/ratings\";\nimport { RatingService } from \"../../services/ratings\";\nimport { useCartCount } from \"../../hooks/cart\";\nimport Details from \"./Details\";\nimport { placedList, dateFilters, psStatusFilters, osStatusFilters, ssStatusFilters } from \"./utils\";\nimport Filters from \"./Filters\"; // import Carts from './Carts';\n\nimport styles from \"./List.module.css\";\n\nfunction OrderList() {\n  _s();\n\n  const params = useQueryParams();\n  const [details] = useCartCount();\n  const enableRating = useIsRatingsEnabled();\n  const place = params.get('placed') || 'all';\n  const [query, setQuery] = useState('');\n  const [dateRangeFilters, setDateRangeFilters] = useState({\n    from: null,\n    to: null\n  });\n  const rated = useIsUserRated();\n  const isEmptyFrom = dateRangeFilters.from === null;\n  const isEmptyTo = dateRangeFilters.to === null;\n  const psFilters = psStatusFilters(params.get('ps'));\n  const ssFilters = ssStatusFilters(params.get('ss'));\n  const osFilters = osStatusFilters(params.get('os'));\n\n  const dateTimeFilters = () => {\n    if (place !== 'custom') {\n      return dateFilters[place];\n    }\n\n    if (isEmptyFrom || isEmptyTo) {\n      return {};\n    }\n\n    return customDateFilters(dateRangeFilters.from, dateRangeFilters.to);\n  };\n\n  const searchFilters = () => {\n    if (query.length > 0) {\n      return {\n        externalId: {\n          $regex: `${query === null || query === void 0 ? void 0 : query.replace('#', '')}`,\n          $options: 'i'\n        }\n      };\n    }\n\n    return {};\n  };\n\n  const filters = { ...dateTimeFilters(),\n    ...psFilters,\n    ...ssFilters,\n    ...osFilters,\n    ...searchFilters()\n  };\n  const [orders, loadMore, hasMore, loading, refresh] = useInfiniteOrders(filters, {\n    createdAt: -1\n  });\n  useEffect(() => {\n    if (((orders === null || orders === void 0 ? void 0 : orders.length) || 0) < 1) {\n      return;\n    }\n\n    if (rated) {\n      return;\n    }\n\n    if (!canTakeRating()) {\n      return;\n    }\n\n    RatingService.open();\n    setRatingShown();\n  }, [(orders === null || orders === void 0 ? void 0 : orders.length) > 1]);\n  const isFree = useIsFreePlan();\n  const history = useHistory();\n  const isCartAbandonmentEnabled = useIsCartAbandonmentEnabled();\n  const isLoading = orders.length === 0 && loading;\n  const id = params.get('id');\n  const rowCount = hasMore ? 10000 : orders.length;\n\n  const isLoaded = i => !!orders[i];\n\n  const height = window.screen.height - 78 - 36 - 8 - 56;\n\n  if (isLoading && !params.has('placed')) {\n    return /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 7\n      }\n    });\n  }\n\n  const show = item => {\n    if ((item === null || item === void 0 ? void 0 : item.status) === 'cart cancelled' || (item === null || item === void 0 ? void 0 : item.orderStatus) === 'cart cancelled') {\n      return !isCartAbandonmentEnabled;\n    }\n\n    return false;\n  }; // eslint-disable-next-line react/no-multi-comp\n\n\n  const renderItem = item => /*#__PURE__*/React.createElement(\"div\", {\n    key: item.key,\n    style: item.style,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(OrderCard, {\n    refresh: refresh,\n    order: orders[item.index],\n    showAlert: show(orders[item.index]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }));\n\n  const onCreateChange = val => {\n    setDateRangeFilters({\n      from: null,\n      to: null\n    });\n    params.set('placed', val);\n    history.push({\n      search: params.toString()\n    });\n  };\n\n  const getRowHeight = x => {\n    const isNotMulti = _.get(orders[x.index], 'items', 1) === 1;\n    return !isNotMulti ? 90 : 134;\n  };\n\n  const stateList = [{\n    label: 'Orders',\n    value: 'orders',\n    isPremium: false\n  }, {\n    label: 'Carts',\n    value: 'carts',\n    isPremium: isFree,\n    count: details === null || details === void 0 ? void 0 : details.count\n  }, {\n    label: 'Reviews',\n    value: 'reviews',\n    isPremium: isFree\n  }];\n\n  const onStateChange = val => {\n    if (val === 'reviews') {\n      if (!enableRating) {\n        params.set('openPlans', 'generic');\n        history.push({\n          search: params.toString()\n        });\n        return;\n      }\n\n      history.push({\n        pathname: '/reviews'\n      });\n    }\n\n    if (val === 'carts') {\n      if (isFree) {\n        params.set('openPlans', 'generic');\n        history.push({\n          search: params.toString()\n        });\n        return;\n      }\n\n      history.push({\n        pathname: '/carts'\n      });\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.header,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spacer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(StatusSelectionBar, {\n    tabClassName: styles.tabClassName1,\n    items: stateList,\n    seperator: true,\n    onChange: onStateChange,\n    active: \"orders\",\n    on: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"spacer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Faq, {\n    withText: false,\n    showItems: ['orders', 'cancellationsReturnsAndRefunds', 'shippingAndDelivery'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: cx('flexBetween', styles.section),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.picker,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Picker, {\n    label: getText(dateRangeFilters),\n    onSelect: e => {\n      setDateRangeFilters(e);\n      params.set('placed', 'custom');\n      history.push({\n        search: params.toString()\n      });\n    },\n    inputStyle: styles.padd0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.search,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Search, {\n    value: query,\n    placeholder: \"Search by order ID\",\n    onChange: e => setQuery(e.target.value) // className={styles.searchCom}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(StatusSelectionBar, {\n    tabClassName: styles.tabClassName,\n    className: styles.tabClass,\n    activeClass: styles.tabActive,\n    items: placedList,\n    onChange: onCreateChange,\n    active: place,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Filters, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.orderHead,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }\n  }, \"Orders List\"), orders.length > 0 ? /*#__PURE__*/React.createElement(InfiniteLoader, {\n    loadMoreRows: loadMore,\n    isRowLoaded: isLoaded,\n    rowCount: rowCount,\n    minimumBatchSize: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  }, ({\n    onRowsRendered,\n    registerChild\n  }) => /*#__PURE__*/React.createElement(List, {\n    height: height,\n    onRowsRendered: onRowsRendered,\n    ref: registerChild,\n    rowCount: orders.length,\n    rowHeight: getRowHeight,\n    rowRenderer: renderItem,\n    width: window.screen.width,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 13\n    }\n  })) : /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.emptyOrders,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: emptyOrder,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.emptyProductText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 11\n    }\n  }, Object.keys(filters).length ? 'No order match the filters, please try again.' : 'You haven\\'t received any orders yet!')), /*#__PURE__*/React.createElement(Details, {\n    open: !!id,\n    id: id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }\n  }));\n}\n\n_s(OrderList, \"Ak0njrm32zUeJUqz7jF5n/6d+kg=\", false, function () {\n  return [useQueryParams, useCartCount, useIsRatingsEnabled, useIsUserRated, useInfiniteOrders, useIsFreePlan, useHistory, useIsCartAbandonmentEnabled];\n});\n\n_c = OrderList;\nexport default OrderList;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderList\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/containers/orders/List.jsx"],"names":["React","useEffect","useState","useHistory","InfiniteLoader","List","useInfiniteOrders","useQueryParams","OrderCard","Loading","Picker","Search","useIsCartAbandonmentEnabled","useIsUserRated","useIsRatingsEnabled","useIsFreePlan","cx","_","Faq","customDateFilters","getText","StatusSelectionBar","canTakeRating","setRatingShown","RatingService","useCartCount","Details","placedList","dateFilters","psStatusFilters","osStatusFilters","ssStatusFilters","Filters","styles","OrderList","params","details","enableRating","place","get","query","setQuery","dateRangeFilters","setDateRangeFilters","from","to","rated","isEmptyFrom","isEmptyTo","psFilters","ssFilters","osFilters","dateTimeFilters","searchFilters","length","externalId","$regex","replace","$options","filters","orders","loadMore","hasMore","loading","refresh","createdAt","open","isFree","history","isCartAbandonmentEnabled","isLoading","id","rowCount","isLoaded","i","height","window","screen","has","show","item","status","orderStatus","renderItem","key","style","index","onCreateChange","val","set","push","search","toString","getRowHeight","x","isNotMulti","stateList","label","value","isPremium","count","onStateChange","pathname","container","header","tabClassName1","section","picker","e","padd0","target","tabClassName","tabClass","tabActive","orderHead","onRowsRendered","registerChild","width","emptyOrders","emptyOrder","emptyProductText","Object","keys"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  InfiniteLoader, List,\n} from 'react-virtualized';\nimport { useInfiniteOrders, useQueryParams } from 'hooks';\nimport { OrderCard } from 'components/orders';\nimport { Loading } from 'components/shared/Loading';\nimport { Picker } from 'components/shared/dateRangePicker/Picker';\nimport emptyOrder from 'assets/overview/newOrder.svg';\n// import chevronLeftDesk from 'assets/images/products/create/back.svg';\nimport { Search } from 'phoenix-components';\nimport {\n  useIsCartAbandonmentEnabled, useIsUserRated, useIsRatingsEnabled,\n  useIsFreePlan,\n} from 'contexts';\nimport cx from 'classnames';\nimport _ from 'lodash';\nimport Faq from 'components/faq/Custom';\nimport { customDateFilters, getText } from 'containers/utils';\nimport { StatusSelectionBar } from 'components/shared/StatusSelectionBar';\nimport { canTakeRating, setRatingShown } from 'utils/ratings';\nimport { RatingService } from 'services/ratings';\nimport { useCartCount } from 'hooks/cart';\nimport Details from './Details';\nimport {\n  placedList,\n  dateFilters,\n  psStatusFilters,\n  osStatusFilters,\n  ssStatusFilters\n} from './utils';\nimport Filters from './Filters';\n// import Carts from './Carts';\nimport styles from './List.module.css';\n\nfunction OrderList() {\n  const params = useQueryParams();\n  const [details] = useCartCount();\n  const enableRating = useIsRatingsEnabled();\n  const place = params.get('placed') || 'all';\n  const [query, setQuery] = useState('');\n  const [dateRangeFilters, setDateRangeFilters] = useState({\n    from: null,\n    to: null\n  });\n  const rated = useIsUserRated();\n  const isEmptyFrom = dateRangeFilters.from === null;\n  const isEmptyTo = dateRangeFilters.to === null;\n\n  const psFilters = psStatusFilters(params.get('ps'));\n  const ssFilters = ssStatusFilters(params.get('ss'));\n  const osFilters = osStatusFilters(params.get('os'));\n\n  const dateTimeFilters = () => {\n    if (place !== 'custom') {\n      return dateFilters[place];\n    }\n    if (isEmptyFrom || isEmptyTo) {\n      return {};\n    }\n    return customDateFilters(dateRangeFilters.from, dateRangeFilters.to);\n  };\n\n  const searchFilters = () => {\n    if (query.length > 0) {\n      return { externalId: { $regex: `${query?.replace('#', '')}`, $options: 'i' } };\n    }\n    return {};\n  };\n\n  const filters = {\n    ...dateTimeFilters(),\n    ...psFilters,\n    ...ssFilters,\n    ...osFilters,\n    ...searchFilters(),\n  };\n\n  const [orders, loadMore, hasMore, loading, refresh] = useInfiniteOrders(filters, {\n    createdAt: -1,\n  });\n\n  useEffect(() => {\n    if ((orders?.length || 0) < 1) {\n      return;\n    }\n    if (rated) {\n      return;\n    }\n    if (!canTakeRating()) {\n      return;\n    }\n    RatingService.open();\n    setRatingShown();\n  }, [orders?.length > 1]);\n\n  const isFree = useIsFreePlan();\n\n  const history = useHistory();\n  const isCartAbandonmentEnabled = useIsCartAbandonmentEnabled();\n  const isLoading = orders.length === 0 && loading;\n\n  const id = params.get('id');\n\n  const rowCount = hasMore ? 10000 : orders.length;\n\n  const isLoaded = i => !!orders[i];\n\n  const height = window.screen.height - 78 - 36 - 8 - 56;\n\n  if (isLoading && !params.has('placed')) {\n    return (\n      <Loading />\n    );\n  }\n\n  const show = (item) => {\n    if (item?.status === 'cart cancelled' || item?.orderStatus === 'cart cancelled') {\n      return !isCartAbandonmentEnabled;\n    }\n    return false;\n  };\n\n  // eslint-disable-next-line react/no-multi-comp\n  const renderItem = (item) => (\n    <div key={item.key} style={item.style}>\n      <OrderCard refresh={refresh} order={orders[item.index]} showAlert={show(orders[item.index])} />\n    </div>\n  );\n\n  const onCreateChange = (val) => {\n    setDateRangeFilters({\n      from: null,\n      to: null\n    });\n    params.set('placed', val);\n    history.push({ search: params.toString() });\n  };\n\n  const getRowHeight = (x) => {\n    const isNotMulti = _.get(orders[x.index], 'items', 1) === 1;\n    return !isNotMulti ? 90 : 134;\n  };\n\n  const stateList = [\n    {\n      label: 'Orders',\n      value: 'orders',\n      isPremium: false,\n    },\n    {\n      label: 'Carts',\n      value: 'carts',\n      isPremium: isFree,\n      count: details?.count,\n    },\n    {\n      label: 'Reviews',\n      value: 'reviews',\n      isPremium: isFree,\n    },\n  ];\n\n  const onStateChange = (val) => {\n    if (val === 'reviews') {\n      if (!enableRating) {\n        params.set('openPlans', 'generic');\n        history.push({\n          search: params.toString(),\n        });\n        return;\n      }\n      history.push({ pathname: '/reviews' });\n    }\n    if (val === 'carts') {\n      if (isFree) {\n        params.set('openPlans', 'generic');\n        history.push({\n          search: params.toString(),\n        });\n        return;\n      }\n      history.push({ pathname: '/carts' });\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <div className=\"spacer\" />\n        <StatusSelectionBar\n          tabClassName={styles.tabClassName1}\n          items={stateList}\n          seperator={true}\n          onChange={onStateChange}\n          active=\"orders\"\n          on\n        />\n        <div className=\"spacer\" />\n        <Faq withText={false} showItems={['orders', 'cancellationsReturnsAndRefunds', 'shippingAndDelivery']} />\n      </div>\n      <div className={cx('flexBetween', styles.section)}>\n        <div className={styles.picker}>\n          <Picker\n            label={getText(dateRangeFilters)}\n            onSelect={(e) => {\n              setDateRangeFilters(e);\n              params.set('placed', 'custom');\n              history.push({ search: params.toString() });\n            }}\n            inputStyle={styles.padd0}\n          />\n        </div>\n        <div className={styles.search}>\n          <Search\n            value={query}\n            placeholder=\"Search by order ID\"\n            onChange={(e) => setQuery(e.target.value)}\n          // className={styles.searchCom}\n          />\n        </div>\n      </div>\n      <StatusSelectionBar\n        tabClassName={styles.tabClassName}\n        className={styles.tabClass}\n        activeClass={styles.tabActive}\n        items={placedList}\n        onChange={onCreateChange}\n        active={place}\n      />\n      <Filters />\n      <div className={styles.orderHead}>\n        Orders List\n      </div>\n\n      {orders.length > 0 ? (\n        <InfiniteLoader\n          loadMoreRows={loadMore}\n          isRowLoaded={isLoaded}\n          rowCount={rowCount}\n          minimumBatchSize={10}\n        >\n          {({\n            onRowsRendered,\n            registerChild\n          }) => (\n            <List\n              height={height}\n              onRowsRendered={onRowsRendered}\n              ref={registerChild}\n              rowCount={orders.length}\n              rowHeight={getRowHeight}\n              rowRenderer={renderItem}\n              width={window.screen.width}\n            />\n          )}\n        </InfiniteLoader>\n      ) : (\n        <div className={styles.emptyOrders}>\n          <img src={emptyOrder} alt=\"\" />\n          <div className={styles.emptyProductText}>\n            {Object.keys(filters).length\n              ? 'No order match the filters, please try again.' : 'You haven\\'t received any orders yet!'}\n          </div>\n\n        </div>\n      )}\n      <Details open={!!id} id={id} />\n\n      {/* {openCarts && <Carts />} */}\n    </div>\n  );\n}\n\nexport default OrderList;\n"]},"metadata":{},"sourceType":"module"}