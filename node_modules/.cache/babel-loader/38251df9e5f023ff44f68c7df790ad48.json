{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/components/subscriptions/SubscriptionCard.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { getFeatures, getPlanImg } from \"../../containers/subscriptions/utils\";\nimport cx from 'classnames';\nimport check from \"../../assets/images/subscriptions/check.svg\";\nimport starIcon from \"../../assets/v2/subscriptions/star.svg\";\nimport infoIcon from \"../../assets/v2/subscriptions/info.svg\";\nimport uncheck from \"../../assets/images/subscriptions/uncheck.svg\";\nimport moment from 'moment';\nimport { Clickable } from 'phoenix-components';\nimport { useDesktop, useIsFreeTrialEnabled, useIsFreeTrialSubscribed, useIsOnFreeTrial, usePlan, useRefreshShop, useShop } from \"../../contexts\";\nimport getSymbolFromCurrency from 'currency-symbol-map';\nimport { getPreFeatures } from \"./utils\";\nimport greenTick from \"../../assets/v2/subscriptions/greenTick.svg\";\nimport WebView from \"../../services/webview\";\nimport URL from \"../../utils/url\";\nimport Loader from \"../../services/loader\";\nimport { Becca } from \"../../api\";\nimport Stripe from \"../../services/stripe\";\nimport SnackBar from \"../../services/snackbar\";\nimport Alert from \"../../containers/subscriptions/Alert\";\nimport { useToggle } from \"../../hooks/common\";\nimport Radios from \"../../containers/subscriptions/Radios\";\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { withStyles } from '@material-ui/core/styles';\nimport bestChoice from \"../../assets/v2/subscriptions/bestChoice.svg\";\nimport { useGooglePlaySupported } from \"../../hooks/webview\";\nimport googleIcon from \"../../assets/v2/subscriptions/google.svg\";\nimport Kbc from \"../knowBaseCards/KnowBaseCards\";\nimport styles from \"./SubscriptionCard.module.css\";\nconst LightTooltip = withStyles(theme => ({\n  tooltip: {\n    backgroundColor: 'rgba(255, 255, 255)',\n    color: 'rgba(33, 33, 33, 0.6)',\n    boxShadow: theme.shadows[1],\n    fontSize: 10\n  }\n}))(Tooltip);\nexport function SubscriptionCard({\n  plan,\n  setPrice,\n  price: priceValidity,\n  details,\n  plans,\n  starSet,\n  startFreeTrial,\n  redirectToPortal,\n  poll\n}) {\n  _s();\n\n  var _plan$name;\n\n  const shop = useShop();\n  const currentPlan = usePlan();\n  const subscribedInTrial = useIsFreeTrialSubscribed();\n  const freeTrialEnabled = useIsFreeTrialEnabled();\n  const isOnFreeTrial = useIsOnFreeTrial();\n  const isIndia = (shop === null || shop === void 0 ? void 0 : shop.country) === 'india';\n  const [openWebPopUp, toggleWebPopUp] = useToggle();\n  const [upgradeAlert, showUpgradeAlert] = useState(false);\n  const isWebView = WebView.isWebView();\n  const isDesktop = useDesktop();\n  const [tooltipIsOpen, setTooltipIsOpen] = useState(false);\n  const mainLogoRef = useRef();\n  const imgRef = useRef();\n  const [height, setHeight] = useState(300);\n  const isPlaySupported = useGooglePlaySupported();\n  const reloadShop = useRefreshShop();\n  const priceEnabled = !(plan.name === 'free' || currentPlan.name === plan.name || (details === null || details === void 0 ? void 0 : details.status) === 'processing');\n  const price = plan === null || plan === void 0 ? void 0 : plan.price.find(p => p.validity === priceValidity);\n  const endDate = moment(details === null || details === void 0 ? void 0 : details.endsAt);\n  const validityLeftInDays = endDate.diff(moment().format(), 'days');\n  const isLTD = !!(details !== null && details !== void 0 && details.ltd);\n  const isPlayEnabled = isPlaySupported && (price === null || price === void 0 ? void 0 : price.googlePlayPriceId) && ((details === null || details === void 0 ? void 0 : details.status) !== 'active' || (details === null || details === void 0 ? void 0 : details.status) === 'active' && isOnFreeTrial && !subscribedInTrial);\n\n  const buyWithPlay = async () => {\n    try {\n      Loader.show();\n      const {\n        id\n      } = await Becca.subscribePlan(plan._id, price._id, URL.getUrl('/subscriptions'), URL.getUrl('/subscriptions'), 'googlePlay');\n      const {\n        token\n      } = await WebView.subscribe(price.googlePlayPriceId);\n      await Becca.activatePlan(id, token);\n      const interval = setInterval(() => {\n        poll(id, interval);\n      }, 3000);\n    } catch (e) {\n      SnackBar.showError((e === null || e === void 0 ? void 0 : e.error) || e);\n      Loader.hide();\n    }\n  };\n\n  const onBuy = async () => {\n    if (isWebView) {\n      WebView.openUrl(URL.generateWebSubscriptionUrl(plan._id, price._id));\n      toggleWebPopUp();\n      return;\n    }\n\n    Loader.show();\n\n    try {\n      const {\n        id\n      } = await Becca.subscribePlan(plan._id, price._id, URL.getUrl('/subscriptions'), URL.getUrl('/subscriptions'));\n      await Stripe.redirectToCheckout(id);\n    } catch (e) {\n      SnackBar.showError(e);\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const getPriceString = () => {\n    if (plan.name === 'free') {\n      return '0';\n    }\n\n    if (!priceEnabled) {\n      if ((details === null || details === void 0 ? void 0 : details.status) === 'active') {\n        return `${price === null || price === void 0 ? void 0 : price.discountedPricePerMonth}`;\n      }\n\n      return `${price === null || price === void 0 ? void 0 : price.discountedPricePerMonth}`;\n    }\n\n    return `${price === null || price === void 0 ? void 0 : price.discountedPricePerMonth}`;\n  };\n\n  const getPretext = () => {\n    if (plan.name === 'free') {\n      return 'Free trial';\n    }\n\n    if (isOnFreeTrial && !subscribedInTrial) {\n      return 'Free trial';\n    }\n\n    return `${plan.description} Plan`;\n  };\n\n  const renderButton = () => {\n    if (freeTrialEnabled && (plan === null || plan === void 0 ? void 0 : plan.name) === 'plus' && (details === null || details === void 0 ? void 0 : details.status) !== 'active') {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        className: cx(styles.freeTrailSection, 'flexColumn'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.trialButtons,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Clickable, {\n        className: styles.back_button,\n        onClick: startFreeTrial,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 15\n        }\n      }, \"Start 14-day free trial\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.freeTrailSubText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }\n      }, \"(No credit card required)\")));\n    }\n  };\n\n  const renderBottomButton = () => {\n    const updatedPlan = plan.name;\n\n    if (plan.name === 'free' && (currentPlan.name === 'free' || (details === null || details === void 0 ? void 0 : details.status) !== 'active') || plan.name === 'plus' && currentPlan.name === 'plus' && (details === null || details === void 0 ? void 0 : details.status) === 'active' && subscribedInTrial || plan.name === 'premium' && currentPlan.name === 'premium' && (details === null || details === void 0 ? void 0 : details.status) === 'active') {\n      return isIndia && validityLeftInDays < 6 && (details === null || details === void 0 ? void 0 : details.provider) === 'stripe' && plan.name === currentPlan.name && (details === null || details === void 0 ? void 0 : details.status) === 'active' && !isOnFreeTrial ? /*#__PURE__*/React.createElement(Clickable, {\n        className: cx(styles.bottomButton, styles.flex),\n        onClick: () => onBuy(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: cx(styles.width50, styles.renew),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 13\n        }\n      }, \"RENEW NOW\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.width50,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: cx(styles.currPlanContainer2),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.currPlan2,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 17\n        }\n      }, \"YOUR CURRENT PLAN\", /*#__PURE__*/React.createElement(\"img\", {\n        className: styles.paddingLeft,\n        src: greenTick,\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 19\n        }\n      })), plan.name !== 'free' && isIndia && !isLTD && /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.autoRenews,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 19\n        }\n      }, \"Expires on\", ' ', moment(details === null || details === void 0 ? void 0 : details.endsAt).format('ll'))))) : /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.bottomButton,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: cx(styles.currPlanContainer, {\n          [styles.paddingTop]: !isIndia && plan.name !== 'free'\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.currPlan,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 15\n        }\n      }, \"YOUR CURRENT PLAN\", /*#__PURE__*/React.createElement(\"img\", {\n        className: styles.paddingLeft,\n        src: greenTick,\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 17\n        }\n      })), plan.name !== 'free' && (!isIndia || (details === null || details === void 0 ? void 0 : details.provider) !== 'stripe') && !isLTD && /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.autoRenews,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 17\n        }\n      }, \"Auto renews on\", ' ', moment(details === null || details === void 0 ? void 0 : details.endsAt).format('ll'))));\n    }\n\n    if (updatedPlan === 'free' && currentPlan.name !== 'free' || updatedPlan === 'plus' && currentPlan.name === 'premium') {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.bottomButton,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.currPlanContainer,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.currPlan,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 13\n        }\n      }, \"UPGRADED\", /*#__PURE__*/React.createElement(\"img\", {\n        className: styles.paddingLeft,\n        src: greenTick,\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 15\n        }\n      }))));\n    }\n\n    if (plan.name === 'plus' && (isOnFreeTrial || (details === null || details === void 0 ? void 0 : details.status) !== 'active') || ((details === null || details === void 0 ? void 0 : details.status) !== 'active' || currentPlan.name !== 'premium') && plan.name === 'premium') {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.bottomButton,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 9\n        }\n      }, isPlayEnabled && /*#__PURE__*/React.createElement(Clickable, {\n        className: styles.gPay,\n        onClick: buyWithPlay,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 13\n        }\n      }, \"PAY WITH\", /*#__PURE__*/React.createElement(\"img\", {\n        src: googleIcon,\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 15\n        }\n      }, \"PAY\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: cx(styles.currPlanContainer, styles.primary),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        onClick: () => {\n          if ((details === null || details === void 0 ? void 0 : details.provider) === 'googlePlay' && currentPlan.name === 'plus' && !isOnFreeTrial) {\n            showUpgradeAlert(true);\n            return;\n          }\n\n          if (isLTD) {\n            showUpgradeAlert(true);\n            return;\n          }\n\n          if (isIndia && plan.name !== 'plus' && currentPlan.name !== 'free') {\n            showUpgradeAlert(true);\n          } else {\n            if (subscribedInTrial && currentPlan.name !== 'free' && !isIndia) {\n              redirectToPortal();\n              return;\n            }\n\n            onBuy();\n          }\n        },\n        className: cx(styles.currPlan, styles.white),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }\n      }, isPlayEnabled ? 'PAY WITH CARD' : 'UPGRADE')));\n    }\n  };\n\n  const priceString = getPriceString();\n  const validityString = '/month';\n  const preFeatures = getPreFeatures(plan.name);\n  const features = getFeatures(plan, plans) || [];\n  const preText = getPretext();\n\n  const onload = e => {\n    const {\n      target\n    } = e;\n    const ht = target.clientHeight + 175;\n    setHeight(ht);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.containerClass,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: mainLogoRef,\n    className: styles.mainLogo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    onLoad: e => onload(e),\n    ref: imgRef,\n    className: styles.logo,\n    src: getPlanImg(plan.name),\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    translate: \"no\",\n    className: styles.planTitleText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 9\n    }\n  }, plan === null || plan === void 0 ? void 0 : plan.description), plan.name === 'plus' && /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.bestchoicetag,\n    src: bestChoice,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 34\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.head,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.main,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.currency,\n    translate: \"no\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 11\n    }\n  }, plan.name === 'free' ? isIndia ? '₹' : '$' : getSymbolFromCurrency(price === null || price === void 0 ? void 0 : price.currency)), /*#__PURE__*/React.createElement(\"span\", {\n    translate: \"no\",\n    className: styles.priceString,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 11\n    }\n  }, priceString), /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.sub,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 11\n    }\n  }, validityString)), plan.name === 'free' && /*#__PURE__*/React.createElement(\"div\", {\n    className: cx(styles.sub1, styles.marginBottom),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 11\n    }\n  }, \"Free Forever\"), plan.name !== 'free' && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.sub1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 11\n    }\n  }, (price === null || price === void 0 ? void 0 : price.validity) <= 31 ? 'Billed Monthly' : 'Billed Annually'), plan.name !== 'free' && !isDesktop && /*#__PURE__*/React.createElement(Radios, {\n    price: plan === null || plan === void 0 ? void 0 : plan.price,\n    selected: price === null || price === void 0 ? void 0 : price._id,\n    setSelected: setPrice,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    style: isDesktop ? {\n      height: `calc(100% - ${height}px)`\n    } : {},\n    className: cx(styles.content, styles[(_plan$name = plan.name) === null || _plan$name === void 0 ? void 0 : _plan$name.toLowerCase()]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.card,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.body,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 11\n    }\n  }, preFeatures.map(x => {\n    if (plan.name === 'free') {\n      if ((details === null || details === void 0 ? void 0 : details.status) !== 'active') {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: x,\n          className: styles.activity1,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: styles.name1,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 347,\n            columnNumber: 23\n          }\n        }, x), /*#__PURE__*/React.createElement(\"img\", {\n          className: styles.tick,\n          src: check,\n          alt: \"\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 23\n          }\n        }));\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: x,\n        className: styles.marginBottom,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 19\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: x,\n      className: styles.activity1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: styles.name1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 19\n      }\n    }, x), /*#__PURE__*/React.createElement(\"img\", {\n      className: styles.tick,\n      src: check,\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 19\n      }\n    }));\n  }), features === null || features === void 0 ? void 0 : features.map((x, i) => /*#__PURE__*/React.createElement(\"div\", {\n    key: x.name,\n    className: styles.activity,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 19\n    }\n  }, x.name), plan.name === 'plus' && starSet.has(x.identifier) && /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.starIcon,\n    src: starIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 27\n    }\n  })), isDesktop ? /*#__PURE__*/React.createElement(LightTooltip, {\n    title: x.description,\n    placement: \"top\",\n    arrow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    onClick: () => {\n      setTooltipIsOpen(i);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.infoIcon,\n    src: infoIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 25\n    }\n  }))) : /*#__PURE__*/React.createElement(LightTooltip, {\n    open: i === tooltipIsOpen,\n    title: x.description,\n    placement: \"top\",\n    onClose: () => setTooltipIsOpen(null),\n    leaveTouchDelay: 5000,\n    arrow: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    onClick: () => {\n      if (tooltipIsOpen === i) {\n        setTooltipIsOpen(null);\n      } else {\n        setTooltipIsOpen(i);\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.infoIcon,\n    src: infoIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 25\n    }\n  })))), /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.tick,\n    src: x.enabled ? check : uncheck,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 17\n    }\n  }))), plan.name === 'plus' && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.starNote,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: starIcon,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 17\n    }\n  }), \"Not included in the free trial\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.hiddenCharges,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 13\n    }\n  }, \"Cancel anytime. No hidden charges.\"), isPlayEnabled && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flexCenter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Clickable, {\n    onClick: onBuy,\n    className: styles.couponCode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 17\n    }\n  }, \"Have coupon code?\")), renderButton(), currentPlan.name === plan.name && !isLTD && /*#__PURE__*/React.createElement(React.Fragment, null, validityLeftInDays > 6 && plan.name !== 'free' && (details === null || details === void 0 ? void 0 : details.status) === 'active' && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.planTimer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 21\n    }\n  }, \"Your\", ' ', preText, ' ', \"ends on\", ' ', moment(details === null || details === void 0 ? void 0 : details.endsAt).format('ll'))), (details === null || details === void 0 ? void 0 : details.status) === 'active' && (!isOnFreeTrial || isOnFreeTrial && subscribedInTrial) && /*#__PURE__*/React.createElement(\"div\", {\n    className: cx('flexCenter'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 19\n    }\n  }, (!isIndia || (details === null || details === void 0 ? void 0 : details.provider) !== 'stripe') && !isLTD && /*#__PURE__*/React.createElement(Clickable, {\n    className: styles.manageSubscription,\n    onClick: redirectToPortal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 23\n    }\n  }, \"Manage your subscription\")))), !isDesktop && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.kbc,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Kbc, {\n    type: \"subscriptions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 15\n    }\n  })))), renderBottomButton(), openWebPopUp && /*#__PURE__*/React.createElement(Alert, {\n    title: 'Whee! You\\'ve chosen to upgrade your plan. We hope you enjoy your next-level shop experience!',\n    subTitle: \"Tap Refresh to update your subscription status\",\n    buttonTitle: \"Refresh\",\n    onClose: () => {\n      reloadShop();\n      toggleWebPopUp();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 9\n    }\n  }), upgradeAlert && /*#__PURE__*/React.createElement(Alert, {\n    onClose: () => {\n      showUpgradeAlert(!upgradeAlert);\n    },\n    buttonTitle: \"Okay\",\n    title: \"Please drop an email to team@windo.live for this request.\",\n    subTitle: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 9\n    }\n  }));\n}\n\n_s(SubscriptionCard, \"H9W+jE8BVpbDAPrE3RJp+ZzAczo=\", false, function () {\n  return [useShop, usePlan, useIsFreeTrialSubscribed, useIsFreeTrialEnabled, useIsOnFreeTrial, useToggle, useDesktop, useGooglePlaySupported, useRefreshShop];\n});\n\n_c = SubscriptionCard;\nSubscriptionCard.propTypes = {\n  plan: PropTypes.object.isRequired,\n  setPrice: PropTypes.func.isRequired,\n  price: PropTypes.number.isRequired,\n  details: PropTypes.object,\n  plans: PropTypes.array.isRequired,\n  starSet: PropTypes.any.isRequired,\n  redirectToPortal: PropTypes.func.isRequired,\n  startFreeTrial: PropTypes.func.isRequired,\n  poll: PropTypes.func.isRequired\n};\nSubscriptionCard.defaultProps = {\n  details: {}\n};\n\nvar _c;\n\n$RefreshReg$(_c, \"SubscriptionCard\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/components/subscriptions/SubscriptionCard.jsx"],"names":["React","useState","useRef","PropTypes","getFeatures","getPlanImg","cx","moment","Clickable","useDesktop","useIsFreeTrialEnabled","useIsFreeTrialSubscribed","useIsOnFreeTrial","usePlan","useRefreshShop","useShop","getSymbolFromCurrency","getPreFeatures","WebView","URL","Loader","Becca","Stripe","SnackBar","Alert","useToggle","Radios","Tooltip","withStyles","useGooglePlaySupported","Kbc","styles","LightTooltip","theme","tooltip","backgroundColor","color","boxShadow","shadows","fontSize","SubscriptionCard","plan","setPrice","price","priceValidity","details","plans","starSet","startFreeTrial","redirectToPortal","poll","shop","currentPlan","subscribedInTrial","freeTrialEnabled","isOnFreeTrial","isIndia","country","openWebPopUp","toggleWebPopUp","upgradeAlert","showUpgradeAlert","isWebView","isDesktop","tooltipIsOpen","setTooltipIsOpen","mainLogoRef","imgRef","height","setHeight","isPlaySupported","reloadShop","priceEnabled","name","status","find","p","validity","endDate","endsAt","validityLeftInDays","diff","format","isLTD","ltd","isPlayEnabled","googlePlayPriceId","buyWithPlay","show","id","subscribePlan","_id","getUrl","token","subscribe","activatePlan","interval","setInterval","e","showError","error","hide","onBuy","openUrl","generateWebSubscriptionUrl","redirectToCheckout","getPriceString","discountedPricePerMonth","getPretext","description","renderButton","freeTrailSection","trialButtons","back_button","freeTrailSubText","renderBottomButton","updatedPlan","provider","bottomButton","flex","width50","renew","currPlanContainer2","currPlan2","paddingLeft","greenTick","autoRenews","currPlanContainer","paddingTop","currPlan","gPay","googleIcon","primary","white","priceString","validityString","preFeatures","features","preText","onload","target","ht","clientHeight","containerClass","mainLogo","logo","planTitleText","bestchoicetag","bestChoice","head","main","currency","sub","sub1","marginBottom","content","toLowerCase","card","body","map","x","activity1","name1","tick","check","i","activity","has","identifier","starIcon","infoIcon","enabled","uncheck","starNote","hiddenCharges","couponCode","planTimer","manageSubscription","kbc","propTypes","object","isRequired","func","number","array","any","defaultProps"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { getFeatures, getPlanImg } from 'containers/subscriptions/utils';\nimport cx from 'classnames';\nimport check from 'assets/images/subscriptions/check.svg';\nimport starIcon from 'assets/v2/subscriptions/star.svg';\nimport infoIcon from 'assets/v2/subscriptions/info.svg';\nimport uncheck from 'assets/images/subscriptions/uncheck.svg';\nimport moment from 'moment';\nimport { Clickable } from 'phoenix-components';\nimport {\n  useDesktop,\n  useIsFreeTrialEnabled,\n  useIsFreeTrialSubscribed,\n  useIsOnFreeTrial,\n  usePlan,\n  useRefreshShop,\n  useShop\n} from 'contexts';\nimport getSymbolFromCurrency from 'currency-symbol-map';\nimport { getPreFeatures } from 'components/subscriptions/utils';\nimport greenTick from 'assets/v2/subscriptions/greenTick.svg';\nimport WebView from 'services/webview';\nimport URL from 'utils/url';\nimport Loader from 'services/loader';\nimport { Becca } from 'api';\nimport Stripe from 'services/stripe';\nimport SnackBar from 'services/snackbar';\nimport Alert from 'containers/subscriptions/Alert';\nimport { useToggle } from 'hooks/common';\nimport Radios from 'containers/subscriptions/Radios';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { withStyles } from '@material-ui/core/styles';\nimport bestChoice from 'assets/v2/subscriptions/bestChoice.svg';\nimport { useGooglePlaySupported } from 'hooks/webview';\nimport googleIcon from 'assets/v2/subscriptions/google.svg';\nimport Kbc from 'components/knowBaseCards/KnowBaseCards';\nimport styles from './SubscriptionCard.module.css';\n\nconst LightTooltip = withStyles((theme) => ({\n  tooltip: {\n    backgroundColor: 'rgba(255, 255, 255)',\n    color: 'rgba(33, 33, 33, 0.6)',\n    boxShadow: theme.shadows[1],\n    fontSize: 10,\n  },\n}))(Tooltip);\n\nexport function SubscriptionCard({\n  plan,\n  setPrice,\n  price: priceValidity,\n  details,\n  plans,\n  starSet,\n  startFreeTrial,\n  redirectToPortal,\n  poll,\n}) {\n  const shop = useShop();\n  const currentPlan = usePlan();\n  const subscribedInTrial = useIsFreeTrialSubscribed();\n  const freeTrialEnabled = useIsFreeTrialEnabled();\n  const isOnFreeTrial = useIsOnFreeTrial();\n  const isIndia = shop?.country === 'india';\n  const [openWebPopUp, toggleWebPopUp] = useToggle();\n  const [upgradeAlert, showUpgradeAlert] = useState(false);\n  const isWebView = WebView.isWebView();\n  const isDesktop = useDesktop();\n  const [tooltipIsOpen, setTooltipIsOpen] = useState(false);\n  const mainLogoRef = useRef();\n  const imgRef = useRef();\n  const [height, setHeight] = useState(300);\n  const isPlaySupported = useGooglePlaySupported();\n\n  const reloadShop = useRefreshShop();\n\n  const priceEnabled = !(plan.name === 'free' || currentPlan.name === plan.name || details?.status === 'processing');\n\n  const price = plan?.price.find(p => p.validity === priceValidity);\n\n  const endDate = moment(details?.endsAt);\n  const validityLeftInDays = endDate.diff(moment().format(), 'days');\n\n  const isLTD = !!details?.ltd;\n\n  const isPlayEnabled = isPlaySupported && price?.googlePlayPriceId && (details?.status !== 'active' || (\n    details?.status === 'active' && isOnFreeTrial && !subscribedInTrial));\n\n  const buyWithPlay = async () => {\n    try {\n      Loader.show();\n      const { id } = await Becca.subscribePlan(\n        plan._id, price._id,\n        URL.getUrl('/subscriptions'),\n        URL.getUrl('/subscriptions'),\n        'googlePlay'\n      );\n      const { token } = await WebView.subscribe(price.googlePlayPriceId);\n      await Becca.activatePlan(id, token);\n      const interval = setInterval(() => {\n        poll(id, interval);\n      }, 3000);\n    } catch (e) {\n      SnackBar.showError(e?.error || e);\n      Loader.hide();\n    }\n  };\n\n  const onBuy = async () => {\n    if (isWebView) {\n      WebView.openUrl(URL.generateWebSubscriptionUrl(plan._id, price._id));\n      toggleWebPopUp();\n      return;\n    }\n    Loader.show();\n    try {\n      const { id } = await Becca.subscribePlan(\n        plan._id, price._id,\n        URL.getUrl('/subscriptions'),\n        URL.getUrl('/subscriptions'),\n      );\n\n      await Stripe.redirectToCheckout(id);\n    } catch (e) {\n      SnackBar.showError(e);\n    } finally {\n      Loader.hide();\n    }\n  };\n\n  const getPriceString = () => {\n    if (plan.name === 'free') {\n      return '0';\n    }\n    if (!priceEnabled) {\n      if (details?.status === 'active') {\n        return `${price?.discountedPricePerMonth}`;\n      }\n      return `${price?.discountedPricePerMonth}`;\n    }\n    return `${price?.discountedPricePerMonth}`;\n  };\n\n  const getPretext = () => {\n    if (plan.name === 'free') {\n      return 'Free trial';\n    }\n    if (isOnFreeTrial && !subscribedInTrial) {\n      return 'Free trial';\n    }\n    return `${plan.description} Plan`;\n  };\n\n  const renderButton = () => {\n    if (freeTrialEnabled && plan?.name === 'plus' && details?.status !== 'active') {\n      return (\n        <>\n          <div className={cx(styles.freeTrailSection, 'flexColumn')}>\n            <div className={styles.trialButtons}>\n              <Clickable\n                className={styles.back_button}\n                onClick={startFreeTrial}\n              >\n                Start 14-day free trial\n              </Clickable>\n            </div>\n            <div className={styles.freeTrailSubText}>\n              (No credit card required)\n            </div>\n          </div>\n        </>\n      );\n    }\n  };\n  const renderBottomButton = () => {\n    const updatedPlan = plan.name;\n    if ((plan.name === 'free' && (currentPlan.name === 'free' || details?.status !== 'active'))\n    || (plan.name === 'plus' && currentPlan.name === 'plus' && details?.status === 'active' && subscribedInTrial)\n    || (plan.name === 'premium' && currentPlan.name === 'premium' && details?.status === 'active')) {\n      return (isIndia && validityLeftInDays < 6 && details?.provider === 'stripe'\n        && (plan.name === currentPlan.name) && details?.status === 'active' && !isOnFreeTrial) ? (\n          <Clickable className={cx(styles.bottomButton, styles.flex)} onClick={() => onBuy()}>\n            <div className={cx(styles.width50, styles.renew)}>\n              RENEW NOW\n            </div>\n            <div className={styles.width50}>\n              <div className={cx(styles.currPlanContainer2)}>\n                <div className={styles.currPlan2}>\n                  YOUR CURRENT PLAN\n                  <img className={styles.paddingLeft} src={greenTick} alt=\"\" />\n                </div>\n                {plan.name !== 'free' && isIndia && !isLTD && (\n                  <div className={styles.autoRenews}>\n                    Expires on\n                    {' '}\n                    {moment(details?.endsAt)\n                      .format('ll')}\n                  </div>\n                )}\n              </div>\n            </div>\n          </Clickable>\n        )\n        : (\n          <div className={styles.bottomButton}>\n            <div className={cx(styles.currPlanContainer, { [styles.paddingTop]: !isIndia && plan.name !== 'free' })}>\n              <div className={styles.currPlan}>\n                YOUR CURRENT PLAN\n                <img className={styles.paddingLeft} src={greenTick} alt=\"\" />\n              </div>\n              {plan.name !== 'free' && (!isIndia || details?.provider !== 'stripe') && (!isLTD) && (\n                <div className={styles.autoRenews}>\n                  Auto renews on\n                  {' '}\n                  {moment(details?.endsAt)\n                    .format('ll')}\n                </div>\n              )}\n            </div>\n          </div>\n        );\n    }\n\n    if ((updatedPlan === 'free' && (currentPlan.name !== 'free'))\n      || (updatedPlan === 'plus' && currentPlan.name === 'premium')) {\n      return (\n        <div className={styles.bottomButton}>\n          <div className={styles.currPlanContainer}>\n            <div className={styles.currPlan}>\n              UPGRADED\n              <img className={styles.paddingLeft} src={greenTick} alt=\"\" />\n            </div>\n          </div>\n        </div>\n      );\n    }\n    if ((plan.name === 'plus' && (isOnFreeTrial || details?.status !== 'active'))\n      || ((details?.status !== 'active' || currentPlan.name !== 'premium') && plan.name === 'premium')) {\n      return (\n        <div className={styles.bottomButton}>\n          {isPlayEnabled && (\n            <Clickable className={styles.gPay} onClick={buyWithPlay}>\n              PAY WITH\n              <img src={googleIcon} alt=\"\" />\n              <span>\n                PAY\n              </span>\n            </Clickable>\n          )}\n          <div className={cx(styles.currPlanContainer, styles.primary)}>\n            <div\n              onClick={() => {\n                if (details?.provider === 'googlePlay' && currentPlan.name === 'plus' && !isOnFreeTrial) {\n                  showUpgradeAlert(true);\n                  return;\n                }\n                if (isLTD) {\n                  showUpgradeAlert(true);\n                  return;\n                }\n                if (isIndia && plan.name !== 'plus' && currentPlan.name !== 'free') {\n                  showUpgradeAlert(true);\n                } else {\n                  if (subscribedInTrial && currentPlan.name !== 'free' && !isIndia) {\n                    redirectToPortal();\n                    return;\n                  }\n                  onBuy();\n                }\n              }}\n              className={cx(styles.currPlan, styles.white)}>\n              {isPlayEnabled ? 'PAY WITH CARD' : 'UPGRADE'}\n            </div>\n          </div>\n        </div>\n      );\n    }\n  };\n\n  const priceString = getPriceString();\n\n  const validityString = '/month';\n\n  const preFeatures = getPreFeatures(plan.name);\n\n  const features = getFeatures(plan, plans) || [];\n\n  const preText = getPretext();\n\n  const onload = (e) => {\n    const { target } = e;\n    const ht = target.clientHeight + 175;\n    setHeight(ht);\n  };\n\n  return (\n    <div className={styles.containerClass}>\n      <div ref={mainLogoRef} className={styles.mainLogo}>\n        <img onLoad={(e) => onload(e)} ref={imgRef} className={styles.logo} src={getPlanImg(plan.name)} alt=\"\" />\n        <div\n          translate=\"no\"\n          className={styles.planTitleText}>\n          {plan?.description}\n        </div>\n        {plan.name === 'plus' && <img className={styles.bestchoicetag} src={bestChoice} alt=\"\" />}\n      </div>\n      <div className={styles.head}>\n        <div className={styles.main}>\n          <span className={styles.currency} translate=\"no\">\n            {plan.name === 'free' ? (isIndia ? '₹' : '$')\n              : getSymbolFromCurrency(price?.currency)}\n\n          </span>\n          <span translate=\"no\" className={styles.priceString}>{priceString}</span>\n          <span className={styles.sub}>{validityString}</span>\n        </div>\n        {plan.name === 'free' && (\n          <div className={cx(styles.sub1, styles.marginBottom)}>\n            Free Forever\n          </div>\n        )}\n        {plan.name !== 'free' && (\n          <div className={styles.sub1}>\n            {price?.validity <= 31 ? 'Billed Monthly' : 'Billed Annually'}\n          </div>\n        )}\n        {plan.name !== 'free' && !isDesktop && (\n          <Radios\n            price={plan?.price}\n            selected={price?._id}\n            setSelected={setPrice}\n          />\n        )}\n      </div>\n      <div\n        style={isDesktop ? { height: `calc(100% - ${height}px)` } : {}}\n        className={cx(styles.content, styles[plan.name?.toLowerCase()])}\n      >\n        <div className={styles.card}>\n          <div className={styles.body}>\n            {preFeatures.map((x) => {\n              if (plan.name === 'free') {\n                if (details?.status !== 'active') {\n                  return (\n                    <div key={x} className={styles.activity1}>\n                      <span className={styles.name1}>{x}</span>\n                      <img className={styles.tick} src={check} alt=\"\" />\n                    </div>\n                  );\n                }\n                return (\n                  <div key={x} className={styles.marginBottom} />\n                );\n              }\n              return (\n                <div key={x} className={styles.activity1}>\n                  <span className={styles.name1}>{x}</span>\n                  <img className={styles.tick} src={check} alt=\"\" />\n                </div>\n              );\n            })}\n            {features?.map((x, i) => (\n              <div key={x.name} className={styles.activity}>\n                <span className={styles.name}>\n                  <span>{x.name}</span>\n                  {plan.name === 'plus' && starSet.has(x.identifier) && (\n                    <span><img className={styles.starIcon} src={starIcon} alt=\"\" /></span>\n                  )}\n                  {isDesktop ? (\n                    <LightTooltip\n                      title={x.description}\n                      placement=\"top\"\n                      arrow>\n                      <span onClick={() => { setTooltipIsOpen(i); }}>\n                        <img className={styles.infoIcon} src={infoIcon} alt=\"\" />\n                      </span>\n                    </LightTooltip>\n                  ) : (\n                    <LightTooltip\n                      open={i === tooltipIsOpen}\n                      title={x.description}\n                      placement=\"top\"\n                      onClose={() => setTooltipIsOpen(null)}\n                      leaveTouchDelay={5000}\n                      arrow>\n                      <span\n                        onClick={() => {\n                          if (tooltipIsOpen === i) { setTooltipIsOpen(null); } else { setTooltipIsOpen(i); }\n                        }}>\n                        <img className={styles.infoIcon} src={infoIcon} alt=\"\" />\n                      </span>\n                    </LightTooltip>\n                  )}\n                </span>\n                <img className={styles.tick} src={x.enabled ? check : uncheck} alt=\"\" />\n              </div>\n            ))}\n            {plan.name === 'plus' && (\n              <div className={styles.starNote}>\n                <img src={starIcon} alt=\"\" />\n                Not included in the free trial\n              </div>\n            )}\n            <div className={styles.hiddenCharges}>Cancel anytime. No hidden charges.</div>\n            {isPlayEnabled && (\n              <div className=\"flexCenter\">\n                <Clickable onClick={onBuy} className={styles.couponCode}>\n                  Have coupon code?\n                </Clickable>\n              </div>\n            )}\n            {renderButton()}\n            {currentPlan.name === plan.name && (!isLTD) && (\n              <>\n                {validityLeftInDays > 6 && plan.name !== 'free' && details?.status === 'active'\n                && (\n                  <div className={styles.planTimer}>\n                    <div>\n                      Your\n                      {' '}\n                      {preText}\n                      {' '}\n                      ends on\n                      {' '}\n                      {moment(details?.endsAt)\n                        .format('ll')}\n                    </div>\n                  </div>\n                )}\n                {details?.status === 'active' && (!isOnFreeTrial || (isOnFreeTrial && subscribedInTrial)) && (\n                  <div className={cx('flexCenter')}>\n                    {(!isIndia || details?.provider !== 'stripe') && (!isLTD) && (\n                      <Clickable\n                        className={styles.manageSubscription}\n                        onClick={redirectToPortal}\n                      >\n                        Manage your subscription\n                      </Clickable>\n                    )}\n                  </div>\n                )}\n              </>\n            )}\n          </div>\n          {!isDesktop\n          && (\n            <div className={styles.kbc}>\n              <Kbc type=\"subscriptions\" />\n            </div>\n          )}\n        </div>\n      </div>\n      {renderBottomButton()}\n      {openWebPopUp && (\n        <Alert\n          title={'Whee! You\\'ve chosen to upgrade your plan. We hope you enjoy your next-level shop experience!'}\n          subTitle=\"Tap Refresh to update your subscription status\"\n          buttonTitle=\"Refresh\"\n          onClose={() => {\n            reloadShop();\n            toggleWebPopUp();\n          }}\n        />\n      )}\n      {upgradeAlert && (\n        <Alert\n          onClose={() => {\n            showUpgradeAlert(!upgradeAlert);\n          }}\n          buttonTitle=\"Okay\"\n          title=\"Please drop an email to team@windo.live for this request.\"\n          subTitle=\"\"\n        />\n      )}\n    </div>\n  );\n}\n\nSubscriptionCard.propTypes = {\n  plan: PropTypes.object.isRequired,\n  setPrice: PropTypes.func.isRequired,\n  price: PropTypes.number.isRequired,\n  details: PropTypes.object,\n  plans: PropTypes.array.isRequired,\n  starSet: PropTypes.any.isRequired,\n  redirectToPortal: PropTypes.func.isRequired,\n  startFreeTrial: PropTypes.func.isRequired,\n  poll: PropTypes.func.isRequired,\n};\n\nSubscriptionCard.defaultProps = {\n  details: {},\n};\n"]},"metadata":{},"sourceType":"module"}