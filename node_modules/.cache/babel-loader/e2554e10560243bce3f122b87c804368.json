{"ast":null,"code":"var _jsxFileName = \"/home/harish/windo/phoenix/src/containers/products/Ratings.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useRef } from 'react';\nimport { useInfiniteRatings } from \"../../hooks/ratings\";\nimport { InfiniteLoader, List, Grid, CellMeasurerCache, CellMeasurer } from 'react-virtualized';\nimport { RatingCard } from \"../../components/products/RatingCard\";\nimport { useParams } from 'react-router-dom';\nimport emptyOrder from \"../../assets/overview/newOrder.svg\";\nimport Header from \"../../components/orders/header/Header\";\nimport { Loading } from \"../../components/shared/Loading\";\nimport { useDesktop } from \"../../contexts\";\nimport chevronLeftDesk from \"../../assets/v2/common/chevronPrimaryLeft.svg\";\nimport { useHistory } from 'react-router-dom';\nimport { useProductDetails } from \"../../components/products/hooks\";\nimport styles from \"./Ratings.module.css\";\nimport { RatingSummary } from \"./RatingSummary\";\n\nfunction Ratings() {\n  _s();\n\n  var _listRef$current;\n\n  const {\n    id\n  } = useParams();\n  const [product, refreshProduct] = useProductDetails(id);\n  const [ratings, loadMore, hasMore,, refreshRatings] = useInfiniteRatings(id, {\n    createdAt: -1\n  });\n  const isDesktop = useDesktop();\n  const listRef = useRef();\n  const cache = new CellMeasurerCache({\n    fixedWidth: true,\n    defaultHeight: 250 - 71 - 45\n  });\n  const deskCache = new CellMeasurerCache({\n    defaultHeight: 155,\n    fixedWidth: true\n  });\n  const rowCount = hasMore ? 10000 : ratings.length;\n  const history = useHistory();\n\n  const isLoaded = i => !!ratings[i];\n\n  const height = window.screen.height - 78 - 36 - 50;\n  const width = listRef === null || listRef === void 0 ? void 0 : (_listRef$current = listRef.current) === null || _listRef$current === void 0 ? void 0 : _listRef$current.clientWidth;\n\n  const refresh = () => {\n    refreshProduct();\n    refreshRatings();\n  }; // eslint-disable-next-line react/no-multi-comp\n\n\n  const renderItem = item => /*#__PURE__*/React.createElement(CellMeasurer, {\n    cache: cache,\n    columnIndex: 0,\n    key: item.key,\n    rowIndex: item.index,\n    parent: item.parent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 5\n    }\n  }, ({\n    measure,\n    registerChild\n  }) => /*#__PURE__*/React.createElement(\"div\", {\n    ref: registerChild,\n    key: item.key,\n    style: item.style,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(RatingCard, {\n    measure: measure,\n    showProduct: false,\n    rating: ratings[item.index],\n    refresh: refresh,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  })));\n\n  const renderCell = el => {\n    const showBorder = el.columnIndex === 0;\n    const idx = el.rowIndex * 2 + el.columnIndex;\n\n    if (idx >= ratings.length) {\n      return null;\n    }\n\n    const {\n      style\n    } = el;\n    return /*#__PURE__*/React.createElement(CellMeasurer, {\n      cache: deskCache,\n      columnIndex: el.columnIndex,\n      key: el.key,\n      parent: el.parent,\n      rowIndex: el.rowIndex,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: { ...style,\n        width: width / 2\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(RatingCard, {\n      showProduct: false,\n      showBorder: showBorder,\n      rating: ratings[idx],\n      refresh: refresh,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }\n    })));\n  };\n\n  const onSectionRendered = onRowsRendered => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 2 + columnStartIndex;\n    const stopIndex = rowStopIndex * 2 + columnStopIndex;\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  if (!ratings) {\n    return /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, isDesktop && /*#__PURE__*/React.createElement(\"div\", {\n    onClick: () => history.goBack(),\n    className: styles.maintitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    className: styles.backIconForDesktop,\n    src: chevronLeftDesk,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, \"\\xA0\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, \"\\xA0\"), \"Reviews\"), !isDesktop && /*#__PURE__*/React.createElement(Header, {\n    showFaq: false,\n    title: \"Reviews\",\n    showItems: ['orders', 'cancellationsReturnsAndRefunds', 'shippingAndDelivery'],\n    onBack: () => history.push(`/products/product/${id}`),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    ref: listRef,\n    className: styles.body,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, ratings.length > 0 && /*#__PURE__*/React.createElement(RatingSummary, {\n    product: {\n      ratings: (product === null || product === void 0 ? void 0 : product.ratings) && (product === null || product === void 0 ? void 0 : product.ratings[id]) || {}\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }), ratings.length === 0 && /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.emptyOrders,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: emptyOrder,\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.emptyProductText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, 'You haven\\'t received any reviews yet!')), /*#__PURE__*/React.createElement(InfiniteLoader, {\n    loadMoreRows: loadMore,\n    isRowLoaded: isLoaded,\n    rowCount: rowCount,\n    minimumBatchSize: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }, ({\n    onRowsRendered,\n    registerChild\n  }) => isDesktop ? /*#__PURE__*/React.createElement(Grid, {\n    onSectionRendered: onSectionRendered(onRowsRendered),\n    ref: registerChild,\n    deferredMeasurementCache: deskCache,\n    cellRenderer: renderCell,\n    columnCount: 2,\n    overscanColumnCount: 0,\n    overscanRowCount: 2,\n    columnWidth: width / 2,\n    height: window.screen.height - 130 - 47,\n    rowCount: Math.ceil(rowCount / 2),\n    rowHeight: deskCache.rowHeight,\n    width: width,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(List, {\n    height: height,\n    onRowsRendered: onRowsRendered,\n    ref: registerChild,\n    rowCount: ratings.length,\n    deferredMeasurementCache: cache,\n    rowHeight: cache.rowHeight,\n    rowRenderer: renderItem,\n    width: window.screen.width - 32,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 15\n    }\n  }))));\n}\n\n_s(Ratings, \"BmCPqoJUouImryXhTD9+KlklhfQ=\", false, function () {\n  return [useParams, useProductDetails, useInfiniteRatings, useDesktop, useHistory];\n});\n\n_c = Ratings;\nRatings.propTypes = {};\nRatings.defaultProps = {};\nexport default Ratings;\n\nvar _c;\n\n$RefreshReg$(_c, \"Ratings\");","map":{"version":3,"sources":["/home/harish/windo/phoenix/src/containers/products/Ratings.jsx"],"names":["React","useRef","useInfiniteRatings","InfiniteLoader","List","Grid","CellMeasurerCache","CellMeasurer","RatingCard","useParams","Header","Loading","useDesktop","useHistory","useProductDetails","styles","RatingSummary","Ratings","id","product","refreshProduct","ratings","loadMore","hasMore","refreshRatings","createdAt","isDesktop","listRef","cache","fixedWidth","defaultHeight","deskCache","rowCount","length","history","isLoaded","i","height","window","screen","width","current","clientWidth","refresh","renderItem","item","key","index","parent","measure","registerChild","style","renderCell","el","showBorder","columnIndex","idx","rowIndex","onSectionRendered","onRowsRendered","columnStartIndex","columnStopIndex","rowStartIndex","rowStopIndex","startIndex","stopIndex","container","goBack","maintitle","backIconForDesktop","chevronLeftDesk","push","body","emptyOrders","emptyOrder","emptyProductText","Math","ceil","rowHeight","propTypes","defaultProps"],"mappings":"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","sourcesContent":["import React, { useRef } from 'react';\nimport { useInfiniteRatings } from 'hooks/ratings';\nimport {\n  InfiniteLoader, List, Grid, CellMeasurerCache, CellMeasurer\n} from 'react-virtualized';\nimport { RatingCard } from 'components/products/RatingCard';\nimport { useParams } from 'react-router-dom';\nimport emptyOrder from 'assets/overview/newOrder.svg';\nimport Header from 'components/orders/header/Header';\nimport { Loading } from 'components/shared/Loading';\nimport { useDesktop } from 'contexts';\nimport chevronLeftDesk from 'assets/v2/common/chevronPrimaryLeft.svg';\nimport { useHistory } from 'react-router-dom';\nimport { useProductDetails } from 'components/products/hooks';\nimport styles from './Ratings.module.css';\nimport { RatingSummary } from './RatingSummary';\n\nfunction Ratings() {\n  const { id } = useParams();\n  const [product, refreshProduct] = useProductDetails(id);\n  const [ratings, loadMore, hasMore, , refreshRatings] = useInfiniteRatings(id, {\n    createdAt: -1,\n  });\n  const isDesktop = useDesktop();\n\n  const listRef = useRef();\n\n  const cache = new CellMeasurerCache({\n    fixedWidth: true,\n    defaultHeight: 250 - 71 - 45\n  });\n\n  const deskCache = new CellMeasurerCache({\n    defaultHeight: 155,\n    fixedWidth: true,\n  });\n\n  const rowCount = hasMore ? 10000 : ratings.length;\n\n  const history = useHistory();\n\n  const isLoaded = i => !!ratings[i];\n\n  const height = window.screen.height - 78 - 36 - 50;\n\n  const width = listRef?.current?.clientWidth;\n\n  const refresh = () => {\n    refreshProduct();\n    refreshRatings();\n  };\n\n  // eslint-disable-next-line react/no-multi-comp\n  const renderItem = (item) => (\n    <CellMeasurer\n      cache={cache}\n      columnIndex={0}\n      key={item.key}\n      rowIndex={item.index}\n      parent={item.parent}>\n      {({ measure, registerChild }) => (\n        <div ref={registerChild} key={item.key} style={item.style}>\n          <RatingCard\n            measure={measure}\n            showProduct={false}\n            rating={ratings[item.index]}\n            refresh={refresh}\n          />\n        </div>\n      )}\n    </CellMeasurer>\n  );\n\n  const renderCell = (el) => {\n    const showBorder = el.columnIndex === 0;\n    const idx = el.rowIndex * 2 + el.columnIndex;\n    if (idx >= ratings.length) {\n      return null;\n    }\n    const { style } = el;\n    return (\n      <CellMeasurer\n        cache={deskCache}\n        columnIndex={el.columnIndex}\n        key={el.key}\n        parent={el.parent}\n        rowIndex={el.rowIndex}\n      >\n        <div\n          style={{\n            ...style,\n            width: width / 2,\n          }}>\n          <RatingCard\n            showProduct={false}\n            showBorder={showBorder}\n            rating={ratings[idx]}\n            refresh={refresh}\n          />\n        </div>\n      </CellMeasurer>\n    );\n  };\n\n  const onSectionRendered = (onRowsRendered) => ({\n    columnStartIndex,\n    columnStopIndex,\n    rowStartIndex,\n    rowStopIndex\n  }) => {\n    const startIndex = rowStartIndex * 2 + columnStartIndex;\n    const stopIndex = rowStopIndex * 2 + columnStopIndex;\n\n    onRowsRendered({\n      startIndex,\n      stopIndex\n    });\n  };\n\n  if (!ratings) {\n    return (\n      <Loading />\n    );\n  }\n\n  return (\n    <div className={styles.container}>\n      {isDesktop && (\n        <div onClick={() => history.goBack()} className={styles.maintitle}>\n          <img className={styles.backIconForDesktop} src={chevronLeftDesk} alt=\"\" />\n          <div>&nbsp;</div>\n          <div>&nbsp;</div>\n          Reviews\n        </div>\n      )}\n      {!isDesktop && (\n        <Header\n          showFaq={false}\n          title=\"Reviews\"\n          showItems={['orders', 'cancellationsReturnsAndRefunds', 'shippingAndDelivery']}\n          onBack={() => history.push(`/products/product/${id}`)}\n        />\n      )}\n      <div ref={listRef} className={styles.body}>\n        {ratings.length > 0 && (\n          <RatingSummary\n            product={{ ratings: (product?.ratings && product?.ratings[id]) || {} }}\n          />\n        )}\n        {\n          ratings.length === 0 && (\n            <div className={styles.emptyOrders}>\n              <img src={emptyOrder} alt=\"\" />\n              <div className={styles.emptyProductText}>\n                {'You haven\\'t received any reviews yet!'}\n              </div>\n            </div>\n          )\n        }\n        <InfiniteLoader\n          loadMoreRows={loadMore}\n          isRowLoaded={isLoaded}\n          rowCount={rowCount}\n          minimumBatchSize={10}\n        >\n          {({\n            onRowsRendered,\n            registerChild\n          }) => (isDesktop ? (\n            <Grid\n              onSectionRendered={onSectionRendered(onRowsRendered)}\n              ref={registerChild}\n              deferredMeasurementCache={deskCache}\n              cellRenderer={renderCell}\n              columnCount={2}\n              overscanColumnCount={0}\n              overscanRowCount={2}\n              columnWidth={((width) / 2)}\n              height={window.screen.height - 130 - 47}\n              rowCount={Math.ceil(rowCount / 2)}\n              rowHeight={deskCache.rowHeight}\n              width={width}\n            />\n          )\n            : (\n              <List\n                height={height}\n                onRowsRendered={onRowsRendered}\n                ref={registerChild}\n                rowCount={ratings.length}\n                deferredMeasurementCache={cache}\n                rowHeight={cache.rowHeight}\n                rowRenderer={renderItem}\n                width={window.screen.width - 32}\n              />\n            ))}\n        </InfiniteLoader>\n      </div>\n    </div>\n  );\n}\n\nRatings.propTypes = {};\n\nRatings.defaultProps = {};\n\nexport default Ratings;\n"]},"metadata":{},"sourceType":"module"}